<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>WebServer: HttpRequestHandler Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">WebServer
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a>  </div>
  <div class="headertitle"><div class="title">HttpRequestHandler Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Handles HTTP requests by parsing, validating, and dispatching them to appropriate response handlers.  
 <a href="#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="../../db/dd7/_http_request_handler_8hpp_source.html">HttpRequestHandler.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a852858343a48d668f0ecdfc495fc0002" id="r_a852858343a48d668f0ecdfc495fc0002"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a852858343a48d668f0ecdfc495fc0002">HttpRequestHandler</a> (const <a class="el" href="../../d3/d42/class_logger.html">Logger</a> *log, <a class="el" href="../../d5/daf/class_client_data.html">ClientData</a> *client_data)</td></tr>
<tr class="memdesc:a852858343a48d668f0ecdfc495fc0002"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs an <a class="el" href="../../d0/d11/class_http_request_handler.html" title="Handles HTTP requests by parsing, validating, and dispatching them to appropriate response handlers.">HttpRequestHandler</a> instance to process and manage HTTP requests.  <br /></td></tr>
<tr class="separator:a852858343a48d668f0ecdfc495fc0002"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32bf6b0e36dbdb4cd0525d2c4b54fdec" id="r_a32bf6b0e36dbdb4cd0525d2c4b54fdec"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a32bf6b0e36dbdb4cd0525d2c4b54fdec">~HttpRequestHandler</a> ()</td></tr>
<tr class="memdesc:a32bf6b0e36dbdb4cd0525d2c4b54fdec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor for <a class="el" href="../../d0/d11/class_http_request_handler.html" title="Handles HTTP requests by parsing, validating, and dispatching them to appropriate response handlers.">HttpRequestHandler</a>.  <br /></td></tr>
<tr class="separator:a32bf6b0e36dbdb4cd0525d2c4b54fdec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97cbf6e2584f097d88cbd5e50ccb22dd" id="r_a97cbf6e2584f097d88cbd5e50ccb22dd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a97cbf6e2584f097d88cbd5e50ccb22dd">request_workflow</a> ()</td></tr>
<tr class="memdesc:a97cbf6e2584f097d88cbd5e50ccb22dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Executes the workflow for processing and validating an HTTP request.  <br /></td></tr>
<tr class="separator:a97cbf6e2584f097d88cbd5e50ccb22dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a275d47883da70a7466b0ea314d1d31ec" id="r_a275d47883da70a7466b0ea314d1d31ec"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a275d47883da70a7466b0ea314d1d31ec">handle_request</a> ()</td></tr>
<tr class="memdesc:a275d47883da70a7466b0ea314d1d31ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Processes the HTTP request and initiates the appropriate response handler.  <br /></td></tr>
<tr class="separator:a275d47883da70a7466b0ea314d1d31ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Handles HTTP requests by parsing, validating, and dispatching them to appropriate response handlers. </p>
<p>The <code><a class="el" href="../../d0/d11/class_http_request_handler.html" title="Handles HTTP requests by parsing, validating, and dispatching them to appropriate response handlers.">HttpRequestHandler</a></code> class is responsible for managing the complete lifecycle of an HTTP request, including:</p><ul>
<li>Parsing request headers, method, path, and any additional data such as query parameters and multipart boundaries.</li>
<li>Validating the request's structure and content.</li>
<li>Determining the appropriate handler based on request type (e.g., standard, CGI, ranged, or multipart).</li>
<li>Generating an error response if the request is invalid or malformed.</li>
</ul>
<p>The class utilizes a series of private validation and parsing steps, executed in sequence through <code>request_workflow</code>. If any step detects an invalid state, it halts the process and sends an error response.</p>
<h2><a class="anchor" id="autotoc_md6"></a>
Attributes</h2>
<ul>
<li><code>_config</code>: Reference to the server configuration.</li>
<li><code>_log</code>: Pointer to the logging utility for logging events and errors.</li>
<li><code>_client_data</code>: Manages client-specific information, including connection state and timing.</li>
<li><code>_cache</code>: Pointer to the server cache to leverage cached responses.</li>
<li><code>_location</code>: Configuration for the specific URL location being requested.</li>
<li><code>_fd</code>: File descriptor associated with the client request.</li>
<li><code>_max_request</code>: Maximum allowed size for request data.</li>
<li><code>_request</code>: Raw request data.</li>
<li><code>_factory</code>: Determines the handler type (standard, CGI, range, etc.).</li>
<li><code>_request_data</code>: Stores parsed request details, including headers, method, path, and body.</li>
</ul>
<p>The class supports CGI requests, ranged requests, multipart uploads, and standard HTTP methods, using helper classes (<code><a class="el" href="../dea/class_http_response_handler.html" title="Manages HTTP responses, with support for caching static file content.">HttpResponseHandler</a></code>, <code><a class="el" href="../../d3/d49/class_http_c_g_i_handler.html" title="Handles HTTP requests that require CGI script execution.">HttpCGIHandler</a></code>, <code><a class="el" href="../../d3/de8/class_http_range_handler.html" title="Manages HTTP requests that include range-specific content, such as partial file downloads.">HttpRangeHandler</a></code>, and <code><a class="el" href="../../d2/d52/class_http_multipart_handler.html" title="Manages HTTP requests with multipart form data for processing and validation.">HttpMultipartHandler</a></code>) to handle each type.</p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="../../dc/d0b/class_web_server_exception.html" title="Custom exception class for handling errors within the web server project.">WebServerException</a></td><td>Thrown for issues with cache, logging, or invalid configurations. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="../dea/class_http_response_handler.html" title="Manages HTTP responses, with support for caching static file content.">HttpResponseHandler</a>, <a class="el" href="../../d3/d49/class_http_c_g_i_handler.html" title="Handles HTTP requests that require CGI script execution.">HttpCGIHandler</a>, <a class="el" href="../../d3/de8/class_http_range_handler.html" title="Manages HTTP requests that include range-specific content, such as partial file downloads.">HttpRangeHandler</a>, <a class="el" href="../../d2/d52/class_http_multipart_handler.html" title="Manages HTTP requests with multipart form data for processing and validation.">HttpMultipartHandler</a> </dd></dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a852858343a48d668f0ecdfc495fc0002" name="a852858343a48d668f0ecdfc495fc0002"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a852858343a48d668f0ecdfc495fc0002">&#9670;&#160;</a></span>HttpRequestHandler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HttpRequestHandler::HttpRequestHandler </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d3/d42/class_logger.html">Logger</a> *</td>          <td class="paramname"><span class="paramname"><em>log</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/daf/class_client_data.html">ClientData</a> *</td>          <td class="paramname"><span class="paramname"><em>client_data</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructs an <a class="el" href="../../d0/d11/class_http_request_handler.html" title="Handles HTTP requests by parsing, validating, and dispatching them to appropriate response handlers.">HttpRequestHandler</a> instance to process and manage HTTP requests. </p>
<p>This constructor initializes the handler with essential pointers and settings for processing HTTP requests. It retrieves configuration details from the associated client data, initializes logging and caching resources, and verifies the validity of the essential components.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">log</td><td>Pointer to a <a class="el" href="../../d3/d42/class_logger.html" title="A simple logging utility for managing log messages with different levels of severity.">Logger</a> instance for logging request handling activities. </td></tr>
    <tr><td class="paramname">client_data</td><td>Pointer to <a class="el" href="../../d5/daf/class_client_data.html" title="Manages individual client connections in the web server, tracking their state and activity.">ClientData</a> associated with the current client connection. </td></tr>
    <tr><td class="paramname">cache</td><td>Pointer to a <a class="el" href="../../dd/d71/class_web_server_cache.html" title="A simple, in-memory Least Recently Used (LRU) cache.">WebServerCache</a> instance to manage cached HTTP responses.</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="../../dd/df7/class_logger_1_1_no_logger_pointer.html" title="Exception thrown when a null pointer to a Logger is used.">Logger::NoLoggerPointer</a></td><td>if the provided logger pointer is null. </td></tr>
    <tr><td class="paramname"><a class="el" href="../../dc/d0b/class_web_server_exception.html" title="Custom exception class for handling errors within the web server project.">WebServerException</a></td><td>if any of the provided pointers (client_data or cache) are null.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>Throws exceptions if essential components (logger, client_data, or cache) are not available, which compromises server functionality. </dd></dl>

</div>
</div>
<a id="a32bf6b0e36dbdb4cd0525d2c4b54fdec" name="a32bf6b0e36dbdb4cd0525d2c4b54fdec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32bf6b0e36dbdb4cd0525d2c4b54fdec">&#9670;&#160;</a></span>~HttpRequestHandler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HttpRequestHandler::~HttpRequestHandler </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destructor for <a class="el" href="../../d0/d11/class_http_request_handler.html" title="Handles HTTP requests by parsing, validating, and dispatching them to appropriate response handlers.">HttpRequestHandler</a>. </p>
<dl class="section note"><dt>Note</dt><dd>This destructor does not perform specific memory deallocation as most resources are managed externally, but it indicates a cleanup phase in logs. </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a275d47883da70a7466b0ea314d1d31ec" name="a275d47883da70a7466b0ea314d1d31ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a275d47883da70a7466b0ea314d1d31ec">&#9670;&#160;</a></span>handle_request()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HttpRequestHandler::handle_request </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Processes the HTTP request and initiates the appropriate response handler. </p>
<p>Based on the request's state and attributes, this function initializes and dispatches a suitable response handler:</p><ul>
<li><code><a class="el" href="../dea/class_http_response_handler.html" title="Manages HTTP responses, with support for caching static file content.">HttpResponseHandler</a></code>: Handles standard HTTP requests.</li>
<li><code><a class="el" href="../../d3/d49/class_http_c_g_i_handler.html" title="Handles HTTP requests that require CGI script execution.">HttpCGIHandler</a></code>: Handles CGI requests.</li>
<li><code><a class="el" href="../../d3/de8/class_http_range_handler.html" title="Manages HTTP requests that include range-specific content, such as partial file downloads.">HttpRangeHandler</a></code>: Manages ranged requests.</li>
<li><code><a class="el" href="../../d2/d52/class_http_multipart_handler.html" title="Manages HTTP requests with multipart form data for processing and validation.">HttpMultipartHandler</a></code>: Handles multipart data uploads.</li>
</ul>
<p>Workflow:</p><ol type="1">
<li><b>Sanity Check</b>: If <code>_request_data.sanity</code> is false, a generic error response is sent via <code><a class="el" href="../dea/class_http_response_handler.html" title="Manages HTTP responses, with support for caching static file content.">HttpResponseHandler</a></code>.</li>
<li><b>Request Type Decision</b>:<ul>
<li>If <code>_request_data.factory</code> is 0, uses <code><a class="el" href="../dea/class_http_response_handler.html" title="Manages HTTP responses, with support for caching static file content.">HttpResponseHandler</a></code>.</li>
<li>If <code>_request_data.cgi</code> is true, uses <code><a class="el" href="../../d3/d49/class_http_c_g_i_handler.html" title="Handles HTTP requests that require CGI script execution.">HttpCGIHandler</a></code>.</li>
<li>If <code>_request_data.range</code> is non-empty, uses <code><a class="el" href="../../d3/de8/class_http_range_handler.html" title="Manages HTTP requests that include range-specific content, such as partial file downloads.">HttpRangeHandler</a></code>.</li>
<li>If <code>_request_data.boundary</code> is non-empty, uses <code><a class="el" href="../../d2/d52/class_http_multipart_handler.html" title="Manages HTTP requests with multipart form data for processing and validation.">HttpMultipartHandler</a></code>. <dl class="section note"><dt>Note</dt><dd>: This method will cache request related info if it was not cached yet, if everything went ok, and if method is get.</dd></dl>
<b>Exception Handling</b>:</li>
</ul>
</li>
</ol>
<ul>
<li>Catches <code><a class="el" href="../../dc/d0b/class_web_server_exception.html" title="Custom exception class for handling errors within the web server project.">WebServerException</a></code>, <code><a class="el" href="../../dd/df7/class_logger_1_1_no_logger_pointer.html" title="Exception thrown when a null pointer to a Logger is used.">Logger::NoLoggerPointer</a></code>, and <code>std::exception</code> to log errors and deactivate the client connection.</li>
</ul>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="../../dc/d0b/class_web_server_exception.html" title="Custom exception class for handling errors within the web server project.">WebServerException</a></td><td>Catches errors from WebServer-specific issues. </td></tr>
    <tr><td class="paramname"><a class="el" href="../../dd/df7/class_logger_1_1_no_logger_pointer.html" title="Exception thrown when a null pointer to a Logger is used.">Logger::NoLoggerPointer</a></td><td>Catches logging pointer errors. </td></tr>
    <tr><td class="paramname">std::exception</td><td>Catches unexpected exceptions. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a97cbf6e2584f097d88cbd5e50ccb22dd" name="a97cbf6e2584f097d88cbd5e50ccb22dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97cbf6e2584f097d88cbd5e50ccb22dd">&#9670;&#160;</a></span>request_workflow()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HttpRequestHandler::request_workflow </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Executes the workflow for processing and validating an HTTP request. </p>
<p>This method manages the step-by-step workflow for parsing and validating an HTTP request, followed by handling the request if it is ready. The workflow is divided into distinct validation steps, each responsible for a specific part of the HTTP request processing.</p>
<p>The method operates as follows:</p><ol type="1">
<li><b>Define Steps</b>:<ul>
<li>An array of function pointers (<code>validate_step</code>) defines the steps for processing:<ul>
<li><code>read_request_header</code>: Reads the HTTP request header from the client.</li>
<li><code>parse_header</code>: Parses the header for key-value pairs.</li>
<li><code>parse_method_and_path</code>: Extracts the HTTP method and requested path.</li>
<li><code>parse_path_type</code>: Determines the type of resource (e.g., file, directory).</li>
<li><code>load_header_data</code>: Loads additional header data needed for processing.</li>
<li><code>load_host_config</code>: Maps the request to the correct host configuration.</li>
<li><code>solver_resource</code>: Resolves the resource requested by the client.</li>
<li><code>load_content</code>: Reads the content of the request, if any.</li>
<li><code>validate_request</code>: Performs final validation of the request's integrity.</li>
</ul>
</li>
</ul>
</li>
<li><b>Check Input State</b>:<ul>
<li>If the request is not ready and the socket is readable (<code>POLLIN</code>), the validation process begins.</li>
</ul>
</li>
<li><b>Execute Validation Steps</b>:<ul>
<li>Iterates through the validation steps sequentially:<ul>
<li>Calls each step using a member function pointer.</li>
<li>Stops the process if the <code>sanity</code> flag indicates a validation failure.</li>
</ul>
</li>
</ul>
</li>
<li><b>Mark Request as Ready</b>:<ul>
<li>If all steps succeed, the request is marked as ready for further handling.</li>
</ul>
</li>
<li><b>Handle Ready Requests</b>:<ul>
<li>If the request is ready and the socket is writable (<code>POLLOUT</code>), the request is processed.</li>
</ul>
</li>
</ol>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">Exceptions</td><td>may occur within individual steps if errors are encountered, such as malformed headers or resource resolution failures. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>websrv/inc/<a class="el" href="../../db/dd7/_http_request_handler_8hpp_source.html">HttpRequestHandler.hpp</a></li>
<li>websrv/srcs/<a class="el" href="../../d2/de6/_http_request_handler_8cpp.html">HttpRequestHandler.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
