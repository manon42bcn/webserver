<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>WebServer: ServerManager Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">WebServer
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a>  </div>
  <div class="headertitle"><div class="title">ServerManager Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Manages the operation of web server instances, client connections, and network events.  
 <a href="#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="../../dc/dfb/_server_manager_8hpp_source.html">ServerManager.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:adda4c1b6ef004e73482c28f48fd55773" id="r_adda4c1b6ef004e73482c28f48fd55773"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adda4c1b6ef004e73482c28f48fd55773">ServerManager</a> (std::vector&lt; <a class="el" href="../../d7/d97/struct_server_config.html">ServerConfig</a> &gt; &amp;configs, const <a class="el" href="../../d3/d42/class_logger.html">Logger</a> *logger)</td></tr>
<tr class="memdesc:adda4c1b6ef004e73482c28f48fd55773"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a <a class="el" href="../../d9/d62/class_server_manager.html" title="Manages the operation of web server instances, client connections, and network events.">ServerManager</a> instance, initializing server configurations and socket handlers.  <br /></td></tr>
<tr class="separator:adda4c1b6ef004e73482c28f48fd55773"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3dcb08af530cec26942c2ce0431f625" id="r_ad3dcb08af530cec26942c2ce0431f625"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad3dcb08af530cec26942c2ce0431f625">~ServerManager</a> ()</td></tr>
<tr class="memdesc:ad3dcb08af530cec26942c2ce0431f625"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor for the <a class="el" href="../../d9/d62/class_server_manager.html" title="Manages the operation of web server instances, client connections, and network events.">ServerManager</a> class, responsible for resource cleanup.  <br /></td></tr>
<tr class="separator:ad3dcb08af530cec26942c2ce0431f625"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecc313c9b6afcab92c22269b3333c721" id="r_aecc313c9b6afcab92c22269b3333c721"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aecc313c9b6afcab92c22269b3333c721">run</a> ()</td></tr>
<tr class="memdesc:aecc313c9b6afcab92c22269b3333c721"><td class="mdescLeft">&#160;</td><td class="mdescRight">Starts and manages the main event loop for the server.  <br /></td></tr>
<tr class="separator:aecc313c9b6afcab92c22269b3333c721"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a739e419ac09105174c345c52765d89f4" id="r_a739e419ac09105174c345c52765d89f4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a739e419ac09105174c345c52765d89f4">turn_off_server</a> ()</td></tr>
<tr class="memdesc:a739e419ac09105174c345c52765d89f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Turn off server.  <br /></td></tr>
<tr class="separator:a739e419ac09105174c345c52765d89f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Manages the operation of web server instances, client connections, and network events. </p>
<p>The <code><a class="el" href="../../d9/d62/class_server_manager.html" title="Manages the operation of web server instances, client connections, and network events.">ServerManager</a></code> class is responsible for:</p><ul>
<li>Initializing and managing multiple server instances (<code><a class="el" href="../../d7/d66/class_socket_handler.html" title="Manages socket operations and configurations for a server.">SocketHandler</a></code> objects) based on the provided configuration.</li>
<li>Maintaining active client connections and polling their events.</li>
<li>Handling critical server functions, such as timeouts, connection cleanup, and error handling.</li>
</ul>
<p>This class uses a <code>poll</code>-based event loop in the <code>run</code> method to handle incoming connections and requests. It provides a shutdown mechanism in case of unrecoverable errors and is equipped with logging for server status tracking. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="adda4c1b6ef004e73482c28f48fd55773" name="adda4c1b6ef004e73482c28f48fd55773"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adda4c1b6ef004e73482c28f48fd55773">&#9670;&#160;</a></span>ServerManager()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ServerManager::ServerManager </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="../../d7/d97/struct_server_config.html">ServerConfig</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>configs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d3/d42/class_logger.html">Logger</a> *</td>          <td class="paramname"><span class="paramname"><em>logger</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructs a <a class="el" href="../../d9/d62/class_server_manager.html" title="Manages the operation of web server instances, client connections, and network events.">ServerManager</a> instance, initializing server configurations and socket handlers. </p>
<p>This constructor initializes the <a class="el" href="../../d9/d62/class_server_manager.html" title="Manages the operation of web server instances, client connections, and network events.">ServerManager</a> with the provided server configurations, logger, and cache. It creates server instances based on the configurations, setting up socket connections and handling potential exceptions related to socket creation, linking, listening, and non-blocking mode.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">configs</td><td>Vector of server configurations, each containing port and other server settings. </td></tr>
    <tr><td class="paramname">logger</td><td>Pointer to the <a class="el" href="../../d3/d42/class_logger.html" title="A simple logging utility for managing log messages with different levels of severity.">Logger</a> instance for logging activities within the <a class="el" href="../../d9/d62/class_server_manager.html" title="Manages the operation of web server instances, client connections, and network events.">ServerManager</a>. </td></tr>
    <tr><td class="paramname">cache</td><td>Pointer to the <a class="el" href="../../dd/d71/class_web_server_cache.html" title="A simple, in-memory Least Recently Used (LRU) cache.">WebServerCache</a> for caching resources.</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="../../dd/df7/class_logger_1_1_no_logger_pointer.html" title="Exception thrown when a null pointer to a Logger is used.">Logger::NoLoggerPointer</a></td><td>If the logger pointer is null. </td></tr>
    <tr><td class="paramname"><a class="el" href="../../dc/d0b/class_web_server_exception.html" title="Custom exception class for handling errors within the web server project.">WebServerException</a></td><td>If no cache pointer is provided, if configs are empty, or if a <a class="el" href="../../d7/d66/class_socket_handler.html" title="Manages socket operations and configurations for a server.">SocketHandler</a> exception is caught.</td></tr>
  </table>
  </dd>
</dl>
<p>This constructor sets up sockets for each configuration in <code>configs</code> using <code>add_server</code>. If any socket operation fails, it logs the error details and throws a <code><a class="el" href="../../dc/d0b/class_web_server_exception.html" title="Custom exception class for handling errors within the web server project.">WebServerException</a></code>. Once initialized successfully, the instance is marked as healthy and active. </p>

</div>
</div>
<a id="ad3dcb08af530cec26942c2ce0431f625" name="ad3dcb08af530cec26942c2ce0431f625"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3dcb08af530cec26942c2ce0431f625">&#9670;&#160;</a></span>~ServerManager()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ServerManager::~ServerManager </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destructor for the <a class="el" href="../../d9/d62/class_server_manager.html" title="Manages the operation of web server instances, client connections, and network events.">ServerManager</a> class, responsible for resource cleanup. </p>
<p>This destructor ensures a proper cleanup of server resources managed by the <a class="el" href="../../d9/d62/class_server_manager.html" title="Manages the operation of web server instances, client connections, and network events.">ServerManager</a> instance. It deactivates and clears client connections, server instances, and poll file descriptors, releasing any associated resources.</p>
<p>The destructor also logs the cleanup process, marking the completion of resource cleanup for easier monitoring and debugging. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aecc313c9b6afcab92c22269b3333c721" name="aecc313c9b6afcab92c22269b3333c721"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecc313c9b6afcab92c22269b3333c721">&#9670;&#160;</a></span>run()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ServerManager::run </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Starts and manages the main event loop for the server. </p>
<p>This method runs the server's event loop, continuously monitoring file descriptors for events using <code>poll()</code>. It handles incoming connections, client requests, and outgoing responses. The loop also manages timeouts for inactive clients and ensures the server remains operational unless a critical error occurs.</p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="../../dc/d0b/class_web_server_exception.html" title="Custom exception class for handling errors within the web server project.">WebServerException</a></td><td>If a fatal error occurs that prevents the server from continuing.</td></tr>
  </table>
  </dd>
</dl>
<p>The main functionalities of the event loop are:</p><ul>
<li><b>Timeout Management:</b> Inactive clients are detected and removed using <code>timeout_clients</code>.</li>
<li><b>Polling for Events:</b> The <code>poll()</code> function is used to monitor file descriptors for readiness to read (<code>POLLIN</code>) or write (<code>POLLOUT</code>).</li>
<li><b>Handling Events:</b><ul>
<li>For <code>POLLIN</code>: Accepts new connections or processes incoming client requests.</li>
<li>For <code>POLLOUT</code>: Sends responses to clients.</li>
</ul>
</li>
<li><b>Error Handling:</b> Handles errors from <code>poll()</code> such as <code>EINTR</code> (interrupted by a signal) or <code>EBADF</code> (bad file descriptor), logging warnings and cleaning up resources as needed.</li>
<li><b>Graceful Shutdown:</b> The loop exits when <code>_active</code> is set to <code>false</code>, ensuring that resources are properly cleaned up.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>The method ensures robustness by catching and logging exceptions, and by cleaning up invalid file descriptors if detected.</li>
<li>A short sleep (<code>usleep</code>) is included to avoid excessive CPU usage during idle periods. </li>
</ul>
</dd></dl>

</div>
</div>
<a id="a739e419ac09105174c345c52765d89f4" name="a739e419ac09105174c345c52765d89f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a739e419ac09105174c345c52765d89f4">&#9670;&#160;</a></span>turn_off_server()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ServerManager::turn_off_server </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Turn off server. </p>
<h1><a class="anchor" id="Functions"></a>
to Build Server.</h1>
<p>This method is be used by signal handler. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>websrv/inc/<a class="el" href="../../dc/dfb/_server_manager_8hpp_source.html">ServerManager.hpp</a></li>
<li>websrv/srcs/<a class="el" href="../../d4/d6d/_server_manager_8cpp.html">ServerManager.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
