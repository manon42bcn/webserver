\doxysection{Http\+Request\+Handler Class Reference}
\hypertarget{class_http_request_handler}{}\label{class_http_request_handler}\index{HttpRequestHandler@{HttpRequestHandler}}


Handles HTTP requests by parsing, validating, and dispatching them to appropriate response handlers.  




{\ttfamily \#include $<$Http\+Request\+Handler.\+hpp$>$}

\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_http_request_handler_a852858343a48d668f0ecdfc495fc0002}{Http\+Request\+Handler}} (const \mbox{\hyperlink{class_logger}{Logger}} \texorpdfstring{$\ast$}{*}log, \mbox{\hyperlink{class_client_data}{Client\+Data}} \texorpdfstring{$\ast$}{*}client\+\_\+data)
\begin{DoxyCompactList}\small\item\em Constructs an \doxylink{class_http_request_handler}{Http\+Request\+Handler} instance to process and manage HTTP requests. \end{DoxyCompactList}\item 
\mbox{\hyperlink{class_http_request_handler_a32bf6b0e36dbdb4cd0525d2c4b54fdec}{\texorpdfstring{$\sim$}{\string~}\+Http\+Request\+Handler}} ()
\begin{DoxyCompactList}\small\item\em Destructor for \doxylink{class_http_request_handler}{Http\+Request\+Handler}. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_http_request_handler_a97cbf6e2584f097d88cbd5e50ccb22dd}{request\+\_\+workflow}} ()
\begin{DoxyCompactList}\small\item\em Executes the main workflow for handling an HTTP request. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Handles HTTP requests by parsing, validating, and dispatching them to appropriate response handlers. 

The {\ttfamily \doxylink{class_http_request_handler}{Http\+Request\+Handler}} class is responsible for managing the complete lifecycle of an HTTP request, including\+:
\begin{DoxyItemize}
\item Parsing request headers, method, path, and any additional data such as query parameters and multipart boundaries.
\item Validating the request\textquotesingle{}s structure and content.
\item Determining the appropriate handler based on request type (e.\+g., standard, CGI, ranged, or multipart).
\item Generating an error response if the request is invalid or malformed.
\end{DoxyItemize}

The class utilizes a series of private validation and parsing steps, executed in sequence through {\ttfamily request\+\_\+workflow}. If any step detects an invalid state, it halts the process and sends an error response.\hypertarget{class_http_request_handler_autotoc_md6}{}\doxysubsubsection{\texorpdfstring{Attributes}{Attributes}}\label{class_http_request_handler_autotoc_md6}

\begin{DoxyItemize}
\item {\ttfamily \+\_\+config}\+: Reference to the server configuration.
\item {\ttfamily \+\_\+log}\+: Pointer to the logging utility for logging events and errors.
\item {\ttfamily \+\_\+client\+\_\+data}\+: Manages client-\/specific information, including connection state and timing.
\item {\ttfamily \+\_\+cache}\+: Pointer to the server cache to leverage cached responses.
\item {\ttfamily \+\_\+location}\+: Configuration for the specific URL location being requested.
\item {\ttfamily \+\_\+fd}\+: File descriptor associated with the client request.
\item {\ttfamily \+\_\+max\+\_\+request}\+: Maximum allowed size for request data.
\item {\ttfamily \+\_\+request}\+: Raw request data.
\item {\ttfamily \+\_\+factory}\+: Determines the handler type (standard, CGI, range, etc.).
\item {\ttfamily \+\_\+request\+\_\+data}\+: Stores parsed request details, including headers, method, path, and body.
\end{DoxyItemize}

The class supports CGI requests, ranged requests, multipart uploads, and standard HTTP methods, using helper classes ({\ttfamily \doxylink{class_http_response_handler}{Http\+Response\+Handler}}, {\ttfamily \doxylink{class_http_c_g_i_handler}{Http\+CGIHandler}}, {\ttfamily \doxylink{class_http_range_handler}{Http\+Range\+Handler}}, and {\ttfamily \doxylink{class_http_multipart_handler}{Http\+Multipart\+Handler}}) to handle each type.


\begin{DoxyExceptions}{Exceptions}
{\em \doxylink{class_web_server_exception}{Web\+Server\+Exception}} & Thrown for issues with cache, logging, or invalid configurations. \\
\hline
\end{DoxyExceptions}
\begin{DoxySeeAlso}{See also}
\doxylink{class_http_response_handler}{Http\+Response\+Handler}, \doxylink{class_http_c_g_i_handler}{Http\+CGIHandler}, \doxylink{class_http_range_handler}{Http\+Range\+Handler}, \doxylink{class_http_multipart_handler}{Http\+Multipart\+Handler} 
\end{DoxySeeAlso}


\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{class_http_request_handler_a852858343a48d668f0ecdfc495fc0002}\index{HttpRequestHandler@{HttpRequestHandler}!HttpRequestHandler@{HttpRequestHandler}}
\index{HttpRequestHandler@{HttpRequestHandler}!HttpRequestHandler@{HttpRequestHandler}}
\doxysubsubsection{\texorpdfstring{HttpRequestHandler()}{HttpRequestHandler()}}
{\footnotesize\ttfamily \label{class_http_request_handler_a852858343a48d668f0ecdfc495fc0002} 
Http\+Request\+Handler\+::\+Http\+Request\+Handler (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_logger}{Logger}} \texorpdfstring{$\ast$}{*}}]{log}{, }\item[{\mbox{\hyperlink{class_client_data}{Client\+Data}} \texorpdfstring{$\ast$}{*}}]{client\+\_\+data}{}\end{DoxyParamCaption})}



Constructs an \doxylink{class_http_request_handler}{Http\+Request\+Handler} instance to process and manage HTTP requests. 

This constructor initializes the handler with essential pointers and settings for processing HTTP requests. It retrieves configuration details from the associated client data, initializes logging and caching resources, and verifies the validity of the essential components.


\begin{DoxyParams}{Parameters}
{\em log} & Pointer to a \doxylink{class_logger}{Logger} instance for logging request handling activities. \\
\hline
{\em client\+\_\+data} & Pointer to \doxylink{class_client_data}{Client\+Data} associated with the current client connection. \\
\hline
{\em cache} & Pointer to a \doxylink{class_web_server_cache}{Web\+Server\+Cache} instance to manage cached HTTP responses.\\
\hline
\end{DoxyParams}

\begin{DoxyExceptions}{Exceptions}
{\em \doxylink{class_logger_1_1_no_logger_pointer}{Logger\+::\+No\+Logger\+Pointer}} & if the provided logger pointer is null. \\
\hline
{\em \doxylink{class_web_server_exception}{Web\+Server\+Exception}} & if any of the provided pointers (client\+\_\+data or cache) are null.\\
\hline
\end{DoxyExceptions}
\begin{DoxyWarning}{Warning}
Throws exceptions if essential components (logger, client\+\_\+data, or cache) are not available, which compromises server functionality. 
\end{DoxyWarning}
\Hypertarget{class_http_request_handler_a32bf6b0e36dbdb4cd0525d2c4b54fdec}\index{HttpRequestHandler@{HttpRequestHandler}!````~HttpRequestHandler@{\texorpdfstring{$\sim$}{\string~}HttpRequestHandler}}
\index{````~HttpRequestHandler@{\texorpdfstring{$\sim$}{\string~}HttpRequestHandler}!HttpRequestHandler@{HttpRequestHandler}}
\doxysubsubsection{\texorpdfstring{\texorpdfstring{$\sim$}{\string~}HttpRequestHandler()}{\string~HttpRequestHandler()}}
{\footnotesize\ttfamily \label{class_http_request_handler_a32bf6b0e36dbdb4cd0525d2c4b54fdec} 
Http\+Request\+Handler\+::\texorpdfstring{$\sim$}{\string~}\+Http\+Request\+Handler (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}



Destructor for \doxylink{class_http_request_handler}{Http\+Request\+Handler}. 

\begin{DoxyNote}{Note}
This destructor does not perform specific memory deallocation as most resources are managed externally, but it indicates a cleanup phase in logs. 
\end{DoxyNote}


\doxysubsection{Member Function Documentation}
\Hypertarget{class_http_request_handler_a97cbf6e2584f097d88cbd5e50ccb22dd}\index{HttpRequestHandler@{HttpRequestHandler}!request\_workflow@{request\_workflow}}
\index{request\_workflow@{request\_workflow}!HttpRequestHandler@{HttpRequestHandler}}
\doxysubsubsection{\texorpdfstring{request\_workflow()}{request\_workflow()}}
{\footnotesize\ttfamily \label{class_http_request_handler_a97cbf6e2584f097d88cbd5e50ccb22dd} 
void Http\+Request\+Handler\+::request\+\_\+workflow (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}



Executes the main workflow for handling an HTTP request. 

This method defines and executes a series of validation and parsing steps to fully handle an HTTP request. It performs tasks such as reading headers, parsing the request, normalizing the path, validating the request, and eventually passing the request to the response handler.

The method performs the following actions\+:


\begin{DoxyEnumerate}
\item {\bfseries{Define Validation Steps}}\+:
\begin{DoxyItemize}
\item Defines an array of function pointers ({\ttfamily steps}) representing each step of the request processing workflow\+:
\begin{DoxyItemize}
\item {\ttfamily read\+\_\+request\+\_\+header()}\+: Reads the incoming request header.
\item {\ttfamily parse\+\_\+header()}\+: Parses the request headers.
\item {\ttfamily parse\+\_\+method\+\_\+and\+\_\+path()}\+: Parses the HTTP method and the requested path.
\item {\ttfamily parse\+\_\+path\+\_\+type()}\+: Determines the type of path being requested.
\item {\ttfamily load\+\_\+header\+\_\+data()}\+: Loads additional header data needed for processing.
\item {\ttfamily solver\+\_\+resource()}\+: Resolves the requested resource path and validates its location.
\item {\ttfamily load\+\_\+content()}\+: Loads the content associated with the request (if applicable).
\item {\ttfamily validate\+\_\+request()}\+: Validates the overall request to ensure it meets server requirements.
\end{DoxyItemize}
\end{DoxyItemize}
\item {\bfseries{Start Request Workflow}}\+:
\begin{DoxyItemize}
\item Logs the beginning of the request parsing and validation process.
\item Calls {\ttfamily \+\_\+client\+\_\+data-\/\texorpdfstring{$>$}{>}chronos\+\_\+reset()} to reset any timers related to the client (e.\+g., request start time).
\end{DoxyItemize}
\item {\bfseries{Execute Validation Steps}}\+:
\begin{DoxyItemize}
\item Iterates through the array of validation steps ({\ttfamily steps}) and executes each one in order using function pointers ({\ttfamily (this-\/\texorpdfstring{$>$}{>}\texorpdfstring{$\ast$}{*}steps\mbox{[}i\mbox{]})()}).
\item After executing each step, checks the {\ttfamily \+\_\+request\+\_\+data.\+sanity} flag\+:
\begin{DoxyItemize}
\item If the flag is {\ttfamily false}, it indicates an error during processing, and the workflow is terminated.
\end{DoxyItemize}
\end{DoxyItemize}
\item {\bfseries{Handle the Request}}\+:
\begin{DoxyItemize}
\item After completing the validation and parsing steps, logs the end of the request validation process.
\item Calls {\ttfamily handle\+\_\+request()} to proceed with responding to the client based on the validated request.
\end{DoxyItemize}
\item {\bfseries{Log Response Completion}}\+:
\begin{DoxyItemize}
\item Logs the end of the response handling process.
\end{DoxyItemize}
\end{DoxyEnumerate}

\begin{DoxyNote}{Note}

\begin{DoxyItemize}
\item The {\ttfamily \+\_\+request\+\_\+data.\+sanity} flag is used throughout the workflow to indicate whether each step was successful. If an error occurs, the flag is set to {\ttfamily false} and the workflow is halted.
\item The workflow consists of multiple steps that handle reading the request, parsing its components, and validating them to ensure the request can be processed correctly.
\end{DoxyItemize}
\end{DoxyNote}
{\bfseries{Validation Steps}}\+:
\begin{DoxyItemize}
\item {\ttfamily read\+\_\+request\+\_\+header()}\+: Reads the raw HTTP headers from the incoming request.
\item {\ttfamily parse\+\_\+header()}\+: Parses and processes each header to extract key-\/value pairs.
\item {\ttfamily parse\+\_\+method\+\_\+and\+\_\+path()}\+: Identifies the HTTP method (e.\+g., GET, POST) and the requested path.
\item {\ttfamily parse\+\_\+path\+\_\+type()}\+: Determines the type of path (e.\+g., static file, dynamic request).
\item {\ttfamily load\+\_\+header\+\_\+data()}\+: Loads additional data from headers required for further processing.
\item {\ttfamily load\+\_\+host\+\_\+config()}\+: Loads host from request, to set its configuration, and update host at Client\+Data\texorpdfstring{$\ast$}{*}
\item {\ttfamily solver\+\_\+resource()}\+: Resolves the requested resource path, potentially handling relative paths.
\item {\ttfamily load\+\_\+content()}\+: Loads request body content if applicable (e.\+g., for POST requests).
\item {\ttfamily validate\+\_\+request()}\+: Final validation to ensure that the request conforms to server policies and rules. 
\end{DoxyItemize}

The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
websrv/inc/\mbox{\hyperlink{_http_request_handler_8hpp}{Http\+Request\+Handler.\+hpp}}\item 
websrv/srcs/\mbox{\hyperlink{_http_request_handler_8cpp}{Http\+Request\+Handler.\+cpp}}\end{DoxyCompactItemize}
