\doxysection{Http\+Request\+Handler Class Reference}
\hypertarget{class_http_request_handler}{}\label{class_http_request_handler}\index{HttpRequestHandler@{HttpRequestHandler}}


Handles HTTP requests by parsing, validating, and dispatching them to appropriate response handlers.  




{\ttfamily \#include $<$Http\+Request\+Handler.\+hpp$>$}

\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_http_request_handler_a852858343a48d668f0ecdfc495fc0002}{Http\+Request\+Handler}} (const \mbox{\hyperlink{class_logger}{Logger}} \texorpdfstring{$\ast$}{*}log, \mbox{\hyperlink{class_client_data}{Client\+Data}} \texorpdfstring{$\ast$}{*}client\+\_\+data)
\begin{DoxyCompactList}\small\item\em Constructs an \doxylink{class_http_request_handler}{Http\+Request\+Handler} instance to process and manage HTTP requests. \end{DoxyCompactList}\item 
\mbox{\hyperlink{class_http_request_handler_a32bf6b0e36dbdb4cd0525d2c4b54fdec}{\texorpdfstring{$\sim$}{\string~}\+Http\+Request\+Handler}} ()
\begin{DoxyCompactList}\small\item\em Destructor for \doxylink{class_http_request_handler}{Http\+Request\+Handler}. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_http_request_handler_a97cbf6e2584f097d88cbd5e50ccb22dd}{request\+\_\+workflow}} ()
\begin{DoxyCompactList}\small\item\em Executes the workflow for processing and validating an HTTP request. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_http_request_handler_a275d47883da70a7466b0ea314d1d31ec}{handle\+\_\+request}} ()
\begin{DoxyCompactList}\small\item\em Processes the HTTP request and initiates the appropriate response handler. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Handles HTTP requests by parsing, validating, and dispatching them to appropriate response handlers. 

The {\ttfamily \doxylink{class_http_request_handler}{Http\+Request\+Handler}} class is responsible for managing the complete lifecycle of an HTTP request, including\+:
\begin{DoxyItemize}
\item Parsing request headers, method, path, and any additional data such as query parameters and multipart boundaries.
\item Validating the request\textquotesingle{}s structure and content.
\item Determining the appropriate handler based on request type (e.\+g., standard, CGI, ranged, or multipart).
\item Generating an error response if the request is invalid or malformed.
\end{DoxyItemize}

The class utilizes a series of private validation and parsing steps, executed in sequence through {\ttfamily request\+\_\+workflow}. If any step detects an invalid state, it halts the process and sends an error response.\hypertarget{class_http_request_handler_autotoc_md6}{}\doxysubsubsection{\texorpdfstring{Attributes}{Attributes}}\label{class_http_request_handler_autotoc_md6}

\begin{DoxyItemize}
\item {\ttfamily \+\_\+config}\+: Reference to the server configuration.
\item {\ttfamily \+\_\+log}\+: Pointer to the logging utility for logging events and errors.
\item {\ttfamily \+\_\+client\+\_\+data}\+: Manages client-\/specific information, including connection state and timing.
\item {\ttfamily \+\_\+cache}\+: Pointer to the server cache to leverage cached responses.
\item {\ttfamily \+\_\+location}\+: Configuration for the specific URL location being requested.
\item {\ttfamily \+\_\+fd}\+: File descriptor associated with the client request.
\item {\ttfamily \+\_\+max\+\_\+request}\+: Maximum allowed size for request data.
\item {\ttfamily \+\_\+request}\+: Raw request data.
\item {\ttfamily \+\_\+factory}\+: Determines the handler type (standard, CGI, range, etc.).
\item {\ttfamily \+\_\+request\+\_\+data}\+: Stores parsed request details, including headers, method, path, and body.
\end{DoxyItemize}

The class supports CGI requests, ranged requests, multipart uploads, and standard HTTP methods, using helper classes ({\ttfamily \doxylink{class_http_response_handler}{Http\+Response\+Handler}}, {\ttfamily \doxylink{class_http_c_g_i_handler}{Http\+CGIHandler}}, {\ttfamily \doxylink{class_http_range_handler}{Http\+Range\+Handler}}, and {\ttfamily \doxylink{class_http_multipart_handler}{Http\+Multipart\+Handler}}) to handle each type.


\begin{DoxyExceptions}{Exceptions}
{\em \doxylink{class_web_server_exception}{Web\+Server\+Exception}} & Thrown for issues with cache, logging, or invalid configurations. \\
\hline
\end{DoxyExceptions}
\begin{DoxySeeAlso}{See also}
\doxylink{class_http_response_handler}{Http\+Response\+Handler}, \doxylink{class_http_c_g_i_handler}{Http\+CGIHandler}, \doxylink{class_http_range_handler}{Http\+Range\+Handler}, \doxylink{class_http_multipart_handler}{Http\+Multipart\+Handler} 
\end{DoxySeeAlso}


\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{class_http_request_handler_a852858343a48d668f0ecdfc495fc0002}\label{class_http_request_handler_a852858343a48d668f0ecdfc495fc0002} 
\index{HttpRequestHandler@{HttpRequestHandler}!HttpRequestHandler@{HttpRequestHandler}}
\index{HttpRequestHandler@{HttpRequestHandler}!HttpRequestHandler@{HttpRequestHandler}}
\doxysubsubsection{\texorpdfstring{HttpRequestHandler()}{HttpRequestHandler()}}
{\footnotesize\ttfamily Http\+Request\+Handler\+::\+Http\+Request\+Handler (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_logger}{Logger}} \texorpdfstring{$\ast$}{*}}]{log,  }\item[{\mbox{\hyperlink{class_client_data}{Client\+Data}} \texorpdfstring{$\ast$}{*}}]{client\+\_\+data }\end{DoxyParamCaption})}



Constructs an \doxylink{class_http_request_handler}{Http\+Request\+Handler} instance to process and manage HTTP requests. 

This constructor initializes the handler with essential pointers and settings for processing HTTP requests. It retrieves configuration details from the associated client data, initializes logging and caching resources, and verifies the validity of the essential components.


\begin{DoxyParams}{Parameters}
{\em log} & Pointer to a \doxylink{class_logger}{Logger} instance for logging request handling activities. \\
\hline
{\em client\+\_\+data} & Pointer to \doxylink{class_client_data}{Client\+Data} associated with the current client connection. \\
\hline
{\em cache} & Pointer to a \doxylink{class_web_server_cache}{Web\+Server\+Cache} instance to manage cached HTTP responses.\\
\hline
\end{DoxyParams}

\begin{DoxyExceptions}{Exceptions}
{\em \doxylink{class_logger_1_1_no_logger_pointer}{Logger\+::\+No\+Logger\+Pointer}} & if the provided logger pointer is null. \\
\hline
{\em \doxylink{class_web_server_exception}{Web\+Server\+Exception}} & if any of the provided pointers (client\+\_\+data or cache) are null.\\
\hline
\end{DoxyExceptions}
\begin{DoxyWarning}{Warning}
Throws exceptions if essential components (logger, client\+\_\+data, or cache) are not available, which compromises server functionality. 
\end{DoxyWarning}
\Hypertarget{class_http_request_handler_a32bf6b0e36dbdb4cd0525d2c4b54fdec}\label{class_http_request_handler_a32bf6b0e36dbdb4cd0525d2c4b54fdec} 
\index{HttpRequestHandler@{HttpRequestHandler}!````~HttpRequestHandler@{\texorpdfstring{$\sim$}{\string~}HttpRequestHandler}}
\index{````~HttpRequestHandler@{\texorpdfstring{$\sim$}{\string~}HttpRequestHandler}!HttpRequestHandler@{HttpRequestHandler}}
\doxysubsubsection{\texorpdfstring{\texorpdfstring{$\sim$}{\string~}HttpRequestHandler()}{\string~HttpRequestHandler()}}
{\footnotesize\ttfamily Http\+Request\+Handler\+::\texorpdfstring{$\sim$}{\string~}\+Http\+Request\+Handler (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Destructor for \doxylink{class_http_request_handler}{Http\+Request\+Handler}. 

\begin{DoxyNote}{Note}
This destructor does not perform specific memory deallocation as most resources are managed externally, but it indicates a cleanup phase in logs. 
\end{DoxyNote}


\doxysubsection{Member Function Documentation}
\Hypertarget{class_http_request_handler_a275d47883da70a7466b0ea314d1d31ec}\label{class_http_request_handler_a275d47883da70a7466b0ea314d1d31ec} 
\index{HttpRequestHandler@{HttpRequestHandler}!handle\_request@{handle\_request}}
\index{handle\_request@{handle\_request}!HttpRequestHandler@{HttpRequestHandler}}
\doxysubsubsection{\texorpdfstring{handle\_request()}{handle\_request()}}
{\footnotesize\ttfamily void Http\+Request\+Handler\+::handle\+\_\+request (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Processes the HTTP request and initiates the appropriate response handler. 

Based on the request\textquotesingle{}s state and attributes, this function initializes and dispatches a suitable response handler\+:
\begin{DoxyItemize}
\item {\ttfamily \doxylink{class_http_response_handler}{Http\+Response\+Handler}}\+: Handles standard HTTP requests.
\item {\ttfamily \doxylink{class_http_c_g_i_handler}{Http\+CGIHandler}}\+: Handles CGI requests.
\item {\ttfamily \doxylink{class_http_range_handler}{Http\+Range\+Handler}}\+: Manages ranged requests.
\item {\ttfamily \doxylink{class_http_multipart_handler}{Http\+Multipart\+Handler}}\+: Handles multipart data uploads.
\end{DoxyItemize}

Workflow\+:
\begin{DoxyEnumerate}
\item {\bfseries{Sanity Check}}\+: If {\ttfamily \+\_\+request\+\_\+data.\+sanity} is false, a generic error response is sent via {\ttfamily \doxylink{class_http_response_handler}{Http\+Response\+Handler}}.
\item {\bfseries{Request Type Decision}}\+:
\begin{DoxyItemize}
\item If {\ttfamily \+\_\+request\+\_\+data.\+factory} is 0, uses {\ttfamily \doxylink{class_http_response_handler}{Http\+Response\+Handler}}.
\item If {\ttfamily \+\_\+request\+\_\+data.\+cgi} is true, uses {\ttfamily \doxylink{class_http_c_g_i_handler}{Http\+CGIHandler}}.
\item If {\ttfamily \+\_\+request\+\_\+data.\+range} is non-\/empty, uses {\ttfamily \doxylink{class_http_range_handler}{Http\+Range\+Handler}}.
\item If {\ttfamily \+\_\+request\+\_\+data.\+boundary} is non-\/empty, uses {\ttfamily \doxylink{class_http_multipart_handler}{Http\+Multipart\+Handler}}. \begin{DoxyNote}{Note}
\+: This method will cache request related info if it was not cached yet, if everything went ok, and if method is get.
\end{DoxyNote}
{\bfseries{Exception Handling}}\+:
\end{DoxyItemize}
\end{DoxyEnumerate}
\begin{DoxyItemize}
\item Catches {\ttfamily \doxylink{class_web_server_exception}{Web\+Server\+Exception}}, {\ttfamily \doxylink{class_logger_1_1_no_logger_pointer}{Logger\+::\+No\+Logger\+Pointer}}, and {\ttfamily std\+::exception} to log errors and deactivate the client connection.
\end{DoxyItemize}


\begin{DoxyExceptions}{Exceptions}
{\em \doxylink{class_web_server_exception}{Web\+Server\+Exception}} & Catches errors from Web\+Server-\/specific issues. \\
\hline
{\em \doxylink{class_logger_1_1_no_logger_pointer}{Logger\+::\+No\+Logger\+Pointer}} & Catches logging pointer errors. \\
\hline
{\em std\+::exception} & Catches unexpected exceptions. \\
\hline
\end{DoxyExceptions}
\Hypertarget{class_http_request_handler_a97cbf6e2584f097d88cbd5e50ccb22dd}\label{class_http_request_handler_a97cbf6e2584f097d88cbd5e50ccb22dd} 
\index{HttpRequestHandler@{HttpRequestHandler}!request\_workflow@{request\_workflow}}
\index{request\_workflow@{request\_workflow}!HttpRequestHandler@{HttpRequestHandler}}
\doxysubsubsection{\texorpdfstring{request\_workflow()}{request\_workflow()}}
{\footnotesize\ttfamily void Http\+Request\+Handler\+::request\+\_\+workflow (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Executes the workflow for processing and validating an HTTP request. 

This method manages the step-\/by-\/step workflow for parsing and validating an HTTP request, followed by handling the request if it is ready. The workflow is divided into distinct validation steps, each responsible for a specific part of the HTTP request processing.

The method operates as follows\+:
\begin{DoxyEnumerate}
\item {\bfseries{Define Steps}}\+:
\begin{DoxyItemize}
\item An array of function pointers ({\ttfamily validate\+\_\+step}) defines the steps for processing\+:
\begin{DoxyItemize}
\item {\ttfamily read\+\_\+request\+\_\+header}\+: Reads the HTTP request header from the client.
\item {\ttfamily parse\+\_\+header}\+: Parses the header for key-\/value pairs.
\item {\ttfamily parse\+\_\+method\+\_\+and\+\_\+path}\+: Extracts the HTTP method and requested path.
\item {\ttfamily parse\+\_\+path\+\_\+type}\+: Determines the type of resource (e.\+g., file, directory).
\item {\ttfamily load\+\_\+header\+\_\+data}\+: Loads additional header data needed for processing.
\item {\ttfamily load\+\_\+host\+\_\+config}\+: Maps the request to the correct host configuration.
\item {\ttfamily solver\+\_\+resource}\+: Resolves the resource requested by the client.
\item {\ttfamily load\+\_\+content}\+: Reads the content of the request, if any.
\item {\ttfamily validate\+\_\+request}\+: Performs final validation of the request\textquotesingle{}s integrity.
\end{DoxyItemize}
\end{DoxyItemize}
\item {\bfseries{Check Input State}}\+:
\begin{DoxyItemize}
\item If the request is not ready and the socket is readable ({\ttfamily POLLIN}), the validation process begins.
\end{DoxyItemize}
\item {\bfseries{Execute Validation Steps}}\+:
\begin{DoxyItemize}
\item Iterates through the validation steps sequentially\+:
\begin{DoxyItemize}
\item Calls each step using a member function pointer.
\item Stops the process if the {\ttfamily sanity} flag indicates a validation failure.
\end{DoxyItemize}
\end{DoxyItemize}
\item {\bfseries{Mark Request as Ready}}\+:
\begin{DoxyItemize}
\item If all steps succeed, the request is marked as ready for further handling.
\end{DoxyItemize}
\item {\bfseries{Handle Ready Requests}}\+:
\begin{DoxyItemize}
\item If the request is ready and the socket is writable ({\ttfamily POLLOUT}), the request is processed.
\end{DoxyItemize}
\end{DoxyEnumerate}


\begin{DoxyExceptions}{Exceptions}
{\em Exceptions} & may occur within individual steps if errors are encountered, such as malformed headers or resource resolution failures. \\
\hline
\end{DoxyExceptions}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
websrv/inc/\mbox{\hyperlink{_http_request_handler_8hpp}{Http\+Request\+Handler.\+hpp}}\item 
websrv/srcs/\mbox{\hyperlink{_http_request_handler_8cpp}{Http\+Request\+Handler.\+cpp}}\end{DoxyCompactItemize}
