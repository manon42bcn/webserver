\doxysection{websrv/srcs/http\+\_\+request\+\_\+helper.cpp File Reference}
\hypertarget{http__request__helper_8cpp}{}\label{http__request__helper_8cpp}\index{websrv/srcs/http\_request\_helper.cpp@{websrv/srcs/http\_request\_helper.cpp}}
{\ttfamily \#include "{}http\+\_\+enum\+\_\+codes.\+hpp"{}}\newline
{\ttfamily \#include $<$map$>$}\newline
{\ttfamily \#include $<$iostream$>$}\newline
{\ttfamily \#include $<$set$>$}\newline
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
std\+::string \mbox{\hyperlink{http__request__helper_8cpp_a411f70b0adb50fb351494b96143fb0ce}{http\+\_\+status\+\_\+description}} (\mbox{\hyperlink{http__enum__codes_8hpp_a991546140b16a555c1d90caffcb0e390}{e\+\_\+http\+\_\+sts}} code)
\begin{DoxyCompactList}\small\item\em Get a standard message for a http code. \end{DoxyCompactList}\item 
\mbox{\hyperlink{http__enum__codes_8hpp_a40092c1e03ca1f11758a2ddb4708958a}{t\+\_\+methods}} \mbox{\hyperlink{http__request__helper_8cpp_ad0ec24b7da0c90f7e3e7a4e4b068a995}{parse\+\_\+method}} (const std\+::string \&method)
\begin{DoxyCompactList}\small\item\em Parses an HTTP method string and returns the corresponding method mask. \end{DoxyCompactList}\item 
std\+::map$<$ std\+::string, std\+::string $>$ \mbox{\hyperlink{http__request__helper_8cpp_a901157cdb2c9069d0f08cab6b799eb60}{create\+\_\+mime\+\_\+types}} ()
\begin{DoxyCompactList}\small\item\em Creates and returns a map of file extensions to MIME types. \end{DoxyCompactList}\item 
std\+::string \mbox{\hyperlink{http__request__helper_8cpp_a83e2cc49561a109eab7a3c41845ef0c7}{get\+\_\+mime\+\_\+type}} (const std\+::string \&path)
\begin{DoxyCompactList}\small\item\em Retrieves the MIME type based on the file extension. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{http__request__helper_8cpp_aac27fe9a0fc4b3f5222a36edb6b54dae}{valid\+\_\+mime\+\_\+type}} (const std\+::string \&path)
\begin{DoxyCompactList}\small\item\em Validate the MIME type based on the file extension. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{http__request__helper_8cpp_a775a50523b2792565271f85e8d63d72b}{black\+\_\+list\+\_\+extension}} (const std\+::string \&path)
\begin{DoxyCompactList}\small\item\em Checks if a given file path has a disallowed extension. \end{DoxyCompactList}\item 
std\+::string \mbox{\hyperlink{http__request__helper_8cpp_a5671fb0d0191f86588463c6e29911fa6}{replace\+\_\+template}} (std\+::string content, const std\+::string \&key, const std\+::string \&value)
\begin{DoxyCompactList}\small\item\em Replaces all occurrences of a key in the content with a given value. \end{DoxyCompactList}\item 
std\+::string \mbox{\hyperlink{http__request__helper_8cpp_a7d8d6608f966337610cf3eaf4b305d7e}{clean\+\_\+host}} (std\+::string \&host\+\_\+to\+\_\+clean)
\begin{DoxyCompactList}\small\item\em Cleans up a host string by removing protocol prefixes, port numbers, and path segments. \end{DoxyCompactList}\item 
std\+::string \mbox{\hyperlink{http__request__helper_8cpp_a34cd1ba4270d9f786fe644a5ac82ba78}{normalize\+\_\+host}} (const std\+::string \&host)
\item 
std\+::string \mbox{\hyperlink{http__request__helper_8cpp_a1405af62ae4c7c679726a051ba7bc3a0}{get\+\_\+header\+\_\+value}} (std\+::string \&haystack, std\+::string needle, const std\+::string \&sep)
\begin{DoxyCompactList}\small\item\em Extracts the value of a specific HTTP header field. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{http__request__helper_8cpp_ab93fb754820f510dc2d17f64ee15a773}{is\+\_\+cgi}} (const std\+::string \&filename)
\begin{DoxyCompactList}\small\item\em Checks if a file is a CGI script based on its extension. \end{DoxyCompactList}\item 
size\+\_\+t \mbox{\hyperlink{http__request__helper_8cpp_add6108cd0eb7f707a1e58ff83b6c8a3a}{end\+\_\+of\+\_\+header\+\_\+system}} (std\+::string \&header)
\begin{DoxyCompactList}\small\item\em Finds the end of the HTTP header in a string. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\Hypertarget{http__request__helper_8cpp_a775a50523b2792565271f85e8d63d72b}\index{http\_request\_helper.cpp@{http\_request\_helper.cpp}!black\_list\_extension@{black\_list\_extension}}
\index{black\_list\_extension@{black\_list\_extension}!http\_request\_helper.cpp@{http\_request\_helper.cpp}}
\doxysubsubsection{\texorpdfstring{black\_list\_extension()}{black\_list\_extension()}}
{\footnotesize\ttfamily \label{http__request__helper_8cpp_a775a50523b2792565271f85e8d63d72b} 
bool black\+\_\+list\+\_\+extension (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{path}{}\end{DoxyParamCaption})}



Checks if a given file path has a disallowed extension. 

This function determines whether the file extension of the provided path is part of a predefined blacklist of disallowed extensions. If the extension is blacklisted, the function returns {\ttfamily true}; otherwise, it returns {\ttfamily false}.


\begin{DoxyParams}{Parameters}
{\em path} & A string representing the file path to check. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily true} if the file\textquotesingle{}s extension is blacklisted; otherwise, {\ttfamily false}.
\end{DoxyReturn}

\begin{DoxyItemize}
\item The function uses a static set of disallowed extensions, which is initialized on the first call. The blacklist includes extensions such as {\ttfamily .exe}, {\ttfamily .bat}, {\ttfamily .sh}, {\ttfamily .php}, {\ttfamily .pl}, and {\ttfamily .py}.
\item The function extracts the file extension by locating the last {\ttfamily .} character in the file path and comparing the substring to the blacklist.
\item If no {\ttfamily .} character is found in the path, or if the extension is not in the blacklist, the function returns {\ttfamily false}. 
\end{DoxyItemize}\Hypertarget{http__request__helper_8cpp_a7d8d6608f966337610cf3eaf4b305d7e}\index{http\_request\_helper.cpp@{http\_request\_helper.cpp}!clean\_host@{clean\_host}}
\index{clean\_host@{clean\_host}!http\_request\_helper.cpp@{http\_request\_helper.cpp}}
\doxysubsubsection{\texorpdfstring{clean\_host()}{clean\_host()}}
{\footnotesize\ttfamily \label{http__request__helper_8cpp_a7d8d6608f966337610cf3eaf4b305d7e} 
std\+::string clean\+\_\+host (\begin{DoxyParamCaption}\item[{std\+::string \&}]{host\+\_\+to\+\_\+clean}{}\end{DoxyParamCaption})}



Cleans up a host string by removing protocol prefixes, port numbers, and path segments. 

This function processes a host string to extract the clean hostname by\+:
\begin{DoxyEnumerate}
\item Removing any leading protocol prefixes (e.\+g., "{}http\+://"{}).
\item Stripping port numbers appended with a colon (e.\+g., "{}\+:8080"{}).
\item Removing any path segments following the hostname (e.\+g., "{}/path/to/resource"{}).
\end{DoxyEnumerate}


\begin{DoxyParams}{Parameters}
{\em host\+\_\+to\+\_\+clean} & A reference to the original host string to be cleaned. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A cleaned host string containing only the hostname without prefixes, ports, or paths.
\end{DoxyReturn}

\begin{DoxyItemize}
\item The function works step by step\+:
\begin{DoxyEnumerate}
\item Finds and removes the {\ttfamily //} sequence, which typically appears in protocol prefixes like "{}http\+://"{}.
\item Removes anything after the last {\ttfamily \+:} to discard port numbers.
\item Iteratively removes any leading {\ttfamily /} characters and paths.
\end{DoxyEnumerate}
\item If the input string does not contain these patterns, it is returned as-\/is.
\end{DoxyItemize}

\begin{DoxyNote}{Note}

\begin{DoxyItemize}
\item This function assumes the input string follows a valid URL-\/like format.
\item The function performs string operations such as {\ttfamily find} and {\ttfamily substr}, which are safe in C++98. 
\end{DoxyItemize}
\end{DoxyNote}
\Hypertarget{http__request__helper_8cpp_a901157cdb2c9069d0f08cab6b799eb60}\index{http\_request\_helper.cpp@{http\_request\_helper.cpp}!create\_mime\_types@{create\_mime\_types}}
\index{create\_mime\_types@{create\_mime\_types}!http\_request\_helper.cpp@{http\_request\_helper.cpp}}
\doxysubsubsection{\texorpdfstring{create\_mime\_types()}{create\_mime\_types()}}
{\footnotesize\ttfamily \label{http__request__helper_8cpp_a901157cdb2c9069d0f08cab6b799eb60} 
std\+::map$<$ std\+::string, std\+::string $>$ create\+\_\+mime\+\_\+types (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}



Creates and returns a map of file extensions to MIME types. 

This method generates a map that associates common file extensions (e.\+g., "{}.\+html"{}, "{}.\+jpg"{}) with their corresponding MIME types (e.\+g., "{}text/html"{}, "{}image/jpeg"{}). The map is used to determine the {\ttfamily Content-\/\+Type} header when serving files.


\begin{DoxyItemize}
\item The method ensures that the map is initialized only once, using a static map to avoid recreating the map on each call. If additional MIME types are required, they can be added to the map.
\item Common MIME types such as {\ttfamily text/html}, {\ttfamily application/javascript}, and {\ttfamily image/jpeg} are included.
\end{DoxyItemize}

\begin{DoxyReturn}{Returns}
std\+::map$<$std\+::string, std\+::string$>$ A map that associates file extensions with their MIME types. 
\end{DoxyReturn}
\Hypertarget{http__request__helper_8cpp_add6108cd0eb7f707a1e58ff83b6c8a3a}\index{http\_request\_helper.cpp@{http\_request\_helper.cpp}!end\_of\_header\_system@{end\_of\_header\_system}}
\index{end\_of\_header\_system@{end\_of\_header\_system}!http\_request\_helper.cpp@{http\_request\_helper.cpp}}
\doxysubsubsection{\texorpdfstring{end\_of\_header\_system()}{end\_of\_header\_system()}}
{\footnotesize\ttfamily \label{http__request__helper_8cpp_add6108cd0eb7f707a1e58ff83b6c8a3a} 
size\+\_\+t end\+\_\+of\+\_\+header\+\_\+system (\begin{DoxyParamCaption}\item[{std\+::string \&}]{header}{}\end{DoxyParamCaption})}



Finds the end of the HTTP header in a string. 

This function locates the end of the HTTP header in the given string by searching for the sequence {\ttfamily \textbackslash{}\textbackslash{}r\textbackslash{}\textbackslash{}n\textbackslash{}\textbackslash{}r\textbackslash{}\textbackslash{}n} or {\ttfamily \textbackslash{}\textbackslash{}n\textbackslash{}\textbackslash{}n}.


\begin{DoxyParams}{Parameters}
{\em header} & The HTTP header string to be analyzed. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The position where the header ends. If no header end is found, returns {\ttfamily std\+::string\+::npos}. 
\end{DoxyReturn}
\Hypertarget{http__request__helper_8cpp_a1405af62ae4c7c679726a051ba7bc3a0}\index{http\_request\_helper.cpp@{http\_request\_helper.cpp}!get\_header\_value@{get\_header\_value}}
\index{get\_header\_value@{get\_header\_value}!http\_request\_helper.cpp@{http\_request\_helper.cpp}}
\doxysubsubsection{\texorpdfstring{get\_header\_value()}{get\_header\_value()}}
{\footnotesize\ttfamily \label{http__request__helper_8cpp_a1405af62ae4c7c679726a051ba7bc3a0} 
std\+::string get\+\_\+header\+\_\+value (\begin{DoxyParamCaption}\item[{std\+::string \&}]{haystack}{, }\item[{std\+::string}]{needle}{, }\item[{const std\+::string \&}]{sep}{}\end{DoxyParamCaption})}



Extracts the value of a specific HTTP header field. 

This method searches the provided header string for a specific key and returns the associated value. The search is case-\/insensitive, and it assumes the format {\ttfamily key\+: value}.


\begin{DoxyItemize}
\item The method first converts the key and the header string to lowercase for a case-\/insensitive search.
\item The value is extracted by searching for the next occurrence of {\ttfamily \textbackslash{}r\textbackslash{}n}, which signifies the end of the value.
\item If the key is not found, the method returns an empty string.
\end{DoxyItemize}


\begin{DoxyParams}{Parameters}
{\em haystack} & The HTTP Header format string to be searched over it. \\
\hline
{\em needle} & The key for which the value is to be retrieved (e.\+g., "{}content-\/type"{}). \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
std\+::string The value associated with the key, or an empty string if the key is not found. 
\end{DoxyReturn}
\Hypertarget{http__request__helper_8cpp_a83e2cc49561a109eab7a3c41845ef0c7}\index{http\_request\_helper.cpp@{http\_request\_helper.cpp}!get\_mime\_type@{get\_mime\_type}}
\index{get\_mime\_type@{get\_mime\_type}!http\_request\_helper.cpp@{http\_request\_helper.cpp}}
\doxysubsubsection{\texorpdfstring{get\_mime\_type()}{get\_mime\_type()}}
{\footnotesize\ttfamily \label{http__request__helper_8cpp_a83e2cc49561a109eab7a3c41845ef0c7} 
std\+::string get\+\_\+mime\+\_\+type (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{path}{}\end{DoxyParamCaption})}



Retrieves the MIME type based on the file extension. 

This method looks up the MIME type corresponding to the file extension in the provided path. If the file extension is recognized, the associated MIME type is returned. If the extension is not recognized, it defaults to {\ttfamily text/plain}.


\begin{DoxyItemize}
\item The method extracts the file extension by searching for the last \textquotesingle{}.\textquotesingle{} character in the path.
\item If the extension is found in the {\ttfamily mime\+\_\+types} map, the corresponding MIME type is returned.
\item If no recognized extension is found, the default MIME type {\ttfamily text/plain} is returned.
\end{DoxyItemize}


\begin{DoxyParams}{Parameters}
{\em path} & The file system path to the file. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
std\+::string The MIME type corresponding to the file extension, or {\ttfamily text/plain} if not found. 
\end{DoxyReturn}
\Hypertarget{http__request__helper_8cpp_a411f70b0adb50fb351494b96143fb0ce}\index{http\_request\_helper.cpp@{http\_request\_helper.cpp}!http\_status\_description@{http\_status\_description}}
\index{http\_status\_description@{http\_status\_description}!http\_request\_helper.cpp@{http\_request\_helper.cpp}}
\doxysubsubsection{\texorpdfstring{http\_status\_description()}{http\_status\_description()}}
{\footnotesize\ttfamily \label{http__request__helper_8cpp_a411f70b0adb50fb351494b96143fb0ce} 
std\+::string http\+\_\+status\+\_\+description (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{http__enum__codes_8hpp_a991546140b16a555c1d90caffcb0e390}{e\+\_\+http\+\_\+sts}}}]{code}{}\end{DoxyParamCaption})}



Get a standard message for a http code. 


\begin{DoxyParams}{Parameters}
{\em code} & http code. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
short standard message associated with the http code. 
\end{DoxyReturn}
\Hypertarget{http__request__helper_8cpp_ab93fb754820f510dc2d17f64ee15a773}\index{http\_request\_helper.cpp@{http\_request\_helper.cpp}!is\_cgi@{is\_cgi}}
\index{is\_cgi@{is\_cgi}!http\_request\_helper.cpp@{http\_request\_helper.cpp}}
\doxysubsubsection{\texorpdfstring{is\_cgi()}{is\_cgi()}}
{\footnotesize\ttfamily \label{http__request__helper_8cpp_ab93fb754820f510dc2d17f64ee15a773} 
bool is\+\_\+cgi (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{filename}{}\end{DoxyParamCaption})}



Checks if a file is a CGI script based on its extension. 

This function checks whether the given filename corresponds to a CGI script by looking at its extension. It checks for extensions such as {\ttfamily .py} and {\ttfamily .php}.


\begin{DoxyParams}{Parameters}
{\em filename} & The filename to be checked. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily true} if the filename corresponds to a CGI script, otherwise {\ttfamily false}. 
\end{DoxyReturn}
\Hypertarget{http__request__helper_8cpp_a34cd1ba4270d9f786fe644a5ac82ba78}\index{http\_request\_helper.cpp@{http\_request\_helper.cpp}!normalize\_host@{normalize\_host}}
\index{normalize\_host@{normalize\_host}!http\_request\_helper.cpp@{http\_request\_helper.cpp}}
\doxysubsubsection{\texorpdfstring{normalize\_host()}{normalize\_host()}}
{\footnotesize\ttfamily \label{http__request__helper_8cpp_a34cd1ba4270d9f786fe644a5ac82ba78} 
std\+::string normalize\+\_\+host (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{host}{}\end{DoxyParamCaption})}

\Hypertarget{http__request__helper_8cpp_ad0ec24b7da0c90f7e3e7a4e4b068a995}\index{http\_request\_helper.cpp@{http\_request\_helper.cpp}!parse\_method@{parse\_method}}
\index{parse\_method@{parse\_method}!http\_request\_helper.cpp@{http\_request\_helper.cpp}}
\doxysubsubsection{\texorpdfstring{parse\_method()}{parse\_method()}}
{\footnotesize\ttfamily \label{http__request__helper_8cpp_ad0ec24b7da0c90f7e3e7a4e4b068a995} 
\mbox{\hyperlink{http__enum__codes_8hpp_a40092c1e03ca1f11758a2ddb4708958a}{t\+\_\+methods}} parse\+\_\+method (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{method}{}\end{DoxyParamCaption})}



Parses an HTTP method string and returns the corresponding method mask. 

This function maps a given HTTP method string (e.\+g., "{}\+GET"{}, "{}\+POST"{}) to its corresponding predefined method mask ({\ttfamily t\+\_\+methods}). If the method is not recognized, it returns 0.


\begin{DoxyParams}{Parameters}
{\em method} & A string representing the HTTP method to parse (e.\+g., "{}\+GET"{}, "{}\+POST"{}). \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The corresponding {\ttfamily t\+\_\+methods} mask if the method is recognized; otherwise, returns 0.
\end{DoxyReturn}

\begin{DoxyItemize}
\item The method uses a static map to store the mapping between HTTP method strings and their corresponding bitmask constants (e.\+g., {\ttfamily MASK\+\_\+\+METHOD\+\_\+\+GET} for "{}\+GET"{}).
\item The map is initialized only once, ensuring efficiency for subsequent calls.
\item If the provided method string is not found in the map, the function returns 0, indicating an unrecognized or unsupported method.
\end{DoxyItemize}

\begin{DoxyNote}{Note}

\begin{DoxyItemize}
\item Supported methods include\+: "{}\+GET"{}, "{}\+POST"{}, "{}\+DELETE"{}, "{}\+PUT"{}, "{}\+HEAD"{}, "{}\+OPTIONS"{}, and "{}\+PATCH"{}.
\item This function is case-\/sensitive. Ensure that the input method string matches the expected format (e.\+g., "{}\+GET"{} must be uppercase). 
\end{DoxyItemize}
\end{DoxyNote}
\Hypertarget{http__request__helper_8cpp_a5671fb0d0191f86588463c6e29911fa6}\index{http\_request\_helper.cpp@{http\_request\_helper.cpp}!replace\_template@{replace\_template}}
\index{replace\_template@{replace\_template}!http\_request\_helper.cpp@{http\_request\_helper.cpp}}
\doxysubsubsection{\texorpdfstring{replace\_template()}{replace\_template()}}
{\footnotesize\ttfamily \label{http__request__helper_8cpp_a5671fb0d0191f86588463c6e29911fa6} 
std\+::string replace\+\_\+template (\begin{DoxyParamCaption}\item[{std\+::string}]{content}{, }\item[{const std\+::string \&}]{key}{, }\item[{const std\+::string \&}]{value}{}\end{DoxyParamCaption})}



Replaces all occurrences of a key in the content with a given value. 

This method searches the provided content for all occurrences of the key and replaces each one with the specified value. It returns the modified content with all replacements made.


\begin{DoxyItemize}
\item The method iterates through the content, finding each occurrence of the key using {\ttfamily std\+::string\+::find()}.
\item For each occurrence, it replaces the key with the value using {\ttfamily std\+::string\+::replace()}.
\item If the value contains the key (which could cause an infinite loop), the method does not perform any replacements.
\end{DoxyItemize}


\begin{DoxyParams}{Parameters}
{\em content} & The content in which to perform the replacements (e.\+g., HTML file content). \\
\hline
{\em key} & The key to search for in the content (e.\+g., "{}\{error\+\_\+code\}"{}). \\
\hline
{\em value} & The value to replace the key with (e.\+g., "{}404"{}). \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
std\+::string The content with all occurrences of the key replaced by the value. 
\end{DoxyReturn}
\Hypertarget{http__request__helper_8cpp_aac27fe9a0fc4b3f5222a36edb6b54dae}\index{http\_request\_helper.cpp@{http\_request\_helper.cpp}!valid\_mime\_type@{valid\_mime\_type}}
\index{valid\_mime\_type@{valid\_mime\_type}!http\_request\_helper.cpp@{http\_request\_helper.cpp}}
\doxysubsubsection{\texorpdfstring{valid\_mime\_type()}{valid\_mime\_type()}}
{\footnotesize\ttfamily \label{http__request__helper_8cpp_aac27fe9a0fc4b3f5222a36edb6b54dae} 
bool valid\+\_\+mime\+\_\+type (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{path}{}\end{DoxyParamCaption})}



Validate the MIME type based on the file extension. 

This method looks up the MIME type corresponding to the file extension in the provided path. If the file extension is recognized, true is returned. If the extension is not recognized, false


\begin{DoxyItemize}
\item The method extracts the file extension by searching for the last \textquotesingle{}.\textquotesingle{} character in the path.
\end{DoxyItemize}


\begin{DoxyParams}{Parameters}
{\em path} & The file system path to the file. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
bool true if a MIME type is recognized, false otherwise. 
\end{DoxyReturn}
