\doxysection{Ws\+Response\+Handler Class Reference}
\hypertarget{class_ws_response_handler}{}\label{class_ws_response_handler}\index{WsResponseHandler@{WsResponseHandler}}


Base class for handling HTTP responses in a web server.  




{\ttfamily \#include $<$Web\+Server\+Response\+Handler.\+hpp$>$}

Inheritance diagram for Ws\+Response\+Handler\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=1.577465cm]{d1/d50/class_ws_response_handler}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_ws_response_handler_a3cd12128a8690f0dfa0d4e5c8619b995}{Ws\+Response\+Handler}} (const \mbox{\hyperlink{struct_location_config}{Location\+Config}} \texorpdfstring{$\ast$}{*}location, const \mbox{\hyperlink{class_logger}{Logger}} \texorpdfstring{$\ast$}{*}log, \mbox{\hyperlink{class_client_data}{Client\+Data}} \texorpdfstring{$\ast$}{*}client\+\_\+data, \mbox{\hyperlink{structs__request}{s\+\_\+request}} \&request, int fd)
\begin{DoxyCompactList}\small\item\em Constructs a {\ttfamily \doxylink{class_ws_response_handler}{Ws\+Response\+Handler}} to manage web server responses. \end{DoxyCompactList}\item 
virtual \mbox{\hyperlink{class_ws_response_handler_a8baab27d8124fd3ec88dc9727b280ac7}{\texorpdfstring{$\sim$}{\string~}\+Ws\+Response\+Handler}} ()
\begin{DoxyCompactList}\small\item\em Destructor for the {\ttfamily \doxylink{class_ws_response_handler}{Ws\+Response\+Handler}} class. \end{DoxyCompactList}\item 
virtual bool \mbox{\hyperlink{class_ws_response_handler_ac424b9087f15dc526de36c473dd0b99b}{handle\+\_\+request}} ()
\begin{DoxyCompactList}\small\item\em Handles the incoming HTTP request based on the request method. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{class_ws_response_handler_abeedbeb84a4e00fcbf33c1864d7c6a15}{send\+\_\+error\+\_\+response}} ()
\begin{DoxyCompactList}\small\item\em Sends an HTTP error response to the client, using a custom error page if available. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{class_ws_response_handler_ac8c8694f89236b819db3906a1e2f1872}{redirection}} ()
\begin{DoxyCompactList}\small\item\em Handles HTTP redirection for the current request. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
virtual bool \mbox{\hyperlink{class_ws_response_handler_aca126bfa03d064a8d94de7ab480b3733}{handle\+\_\+get}} ()
\begin{DoxyCompactList}\small\item\em Handles HTTP GET requests, validating access, resource data, and sending a response. \end{DoxyCompactList}\item 
virtual bool \mbox{\hyperlink{class_ws_response_handler_a644b3ca7a7cec3dc191f182fb47cc68f}{handle\+\_\+post}} ()
\begin{DoxyCompactList}\small\item\em Handles HTTP POST requests, validating access, saving data, and sending a response. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{class_ws_response_handler_a1e1d6f36fa589140b0feb50013295720}{handle\+\_\+delete}} ()
\begin{DoxyCompactList}\small\item\em Handles HTTP DELETE requests by checking permissions and deleting the specified resource. \end{DoxyCompactList}\item 
virtual bool \mbox{\hyperlink{class_ws_response_handler_aaa165d0cdad3ce51a5e1bd755b501277}{validate\+\_\+payload}} ()
\begin{DoxyCompactList}\small\item\em Validates the payload of an HTTP request to ensure it meets requirements. \end{DoxyCompactList}\item 
virtual void \mbox{\hyperlink{class_ws_response_handler_a13110e781354f17e2628be2c9a5c89ae}{get\+\_\+file\+\_\+content}} (int pid, int(\&fd)\mbox{[}2\mbox{]})=0
\item 
virtual void \mbox{\hyperlink{class_ws_response_handler_aa5f538a7d770aecb593e27cbae11bebb}{get\+\_\+file\+\_\+content}} (std\+::string \&path)
\begin{DoxyCompactList}\small\item\em Retrieves the content of a file specified by the path. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{class_ws_response_handler_a567d0413981e44eae8146cba69ae8a7a}{save\+\_\+file}} (const std\+::string \&save\+\_\+path, const std\+::string \&content)
\begin{DoxyCompactList}\small\item\em Saves the provided content to a specified file path. \end{DoxyCompactList}\item 
virtual std\+::string \mbox{\hyperlink{class_ws_response_handler_a1f6fa4b16b1bb217c5c76f84de70cd0b}{header}} (int code, size\+\_\+t content\+\_\+size, std\+::string mime)
\begin{DoxyCompactList}\small\item\em Constructs an HTTP response header based on provided parameters. \end{DoxyCompactList}\item 
virtual bool \mbox{\hyperlink{class_ws_response_handler_ac1c7496ce4287eb698166bbe52852cfa}{send\+\_\+response}} (const std\+::string \&body, const std\+::string \&path)
\begin{DoxyCompactList}\small\item\em Sends an HTTP response with the specified body content and inferred MIME type. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{class_ws_response_handler_a01217e2efc87284c0642d2a4341fc26b}{sender}} (const std\+::string \&body)
\begin{DoxyCompactList}\small\item\em Sends the HTTP response to the client through the socket file descriptor. \end{DoxyCompactList}\item 
std\+::string \mbox{\hyperlink{class_ws_response_handler_a1b93f248882a4eda90403c83321071a4}{default\+\_\+plain\+\_\+error}} ()
\begin{DoxyCompactList}\small\item\em Generates a default HTML error page for the HTTP response. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_ws_response_handler_ad11ac0e6036e8a641cfe74569c47314f}{turn\+\_\+off\+\_\+sanity}} (\mbox{\hyperlink{http__enum__codes_8hpp_a991546140b16a555c1d90caffcb0e390}{e\+\_\+http\+\_\+sts}} status, std\+::string detail)
\begin{DoxyCompactList}\small\item\em Disables further request processing by marking the request as invalid. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
const \mbox{\hyperlink{struct_location_config}{Location\+Config}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{class_ws_response_handler_a85c6c1dda9c16243a5cb1cbe7d7981e8}{\+\_\+location}}
\item 
const \mbox{\hyperlink{class_logger}{Logger}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{class_ws_response_handler_ad16c39c951b521fbb836260bfdd620b2}{\+\_\+log}}
\item 
\mbox{\hyperlink{class_client_data}{Client\+Data}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{class_ws_response_handler_ab10cfb3b580bd147399038a7a2431e9b}{\+\_\+client\+\_\+data}}
\item 
\mbox{\hyperlink{structs__request}{s\+\_\+request}} \& \mbox{\hyperlink{class_ws_response_handler_a394876bb9233128373d9aa1c2a6fb392}{\+\_\+request}}
\item 
\mbox{\hyperlink{structs__content}{s\+\_\+content}} \mbox{\hyperlink{class_ws_response_handler_a67ccf1b36d737f643651b8df1d207870}{\+\_\+response\+\_\+data}}
\item 
std\+::string \mbox{\hyperlink{class_ws_response_handler_ad89c7d5cc6459655f69f0f4db824757f}{\+\_\+headers}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Base class for handling HTTP responses in a web server. 

The {\ttfamily \doxylink{class_ws_response_handler}{Ws\+Response\+Handler}} class manages the processing of HTTP responses, supporting GET, POST, and DELETE operations. It handles file reading, content validation, response headers, error responses, and client interactions. Derived classes can implement additional logic, including specialized response handling such as for multipart or CGI responses. 

\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{class_ws_response_handler_a3cd12128a8690f0dfa0d4e5c8619b995}\index{WsResponseHandler@{WsResponseHandler}!WsResponseHandler@{WsResponseHandler}}
\index{WsResponseHandler@{WsResponseHandler}!WsResponseHandler@{WsResponseHandler}}
\doxysubsubsection{\texorpdfstring{WsResponseHandler()}{WsResponseHandler()}}
{\footnotesize\ttfamily \label{class_ws_response_handler_a3cd12128a8690f0dfa0d4e5c8619b995} 
Ws\+Response\+Handler\+::\+Ws\+Response\+Handler (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{struct_location_config}{Location\+Config}} \texorpdfstring{$\ast$}{*}}]{location}{, }\item[{const \mbox{\hyperlink{class_logger}{Logger}} \texorpdfstring{$\ast$}{*}}]{log}{, }\item[{\mbox{\hyperlink{class_client_data}{Client\+Data}} \texorpdfstring{$\ast$}{*}}]{client\+\_\+data}{, }\item[{\mbox{\hyperlink{structs__request}{s\+\_\+request}} \&}]{request}{, }\item[{int}]{fd}{}\end{DoxyParamCaption})}



Constructs a {\ttfamily \doxylink{class_ws_response_handler}{Ws\+Response\+Handler}} to manage web server responses. 

Initializes the {\ttfamily \doxylink{class_ws_response_handler}{Ws\+Response\+Handler}} with essential components for handling server responses, including location configuration, logging, client data, request details, and the client\textquotesingle{}s file descriptor.


\begin{DoxyParams}{Parameters}
{\em location} & Pointer to the {\ttfamily \doxylink{struct_location_config}{Location\+Config}} containing the location-\/specific configuration. \\
\hline
{\em log} & Pointer to the {\ttfamily \doxylink{class_logger}{Logger}} instance for logging activities and errors. \\
\hline
{\em client\+\_\+data} & Pointer to the {\ttfamily \doxylink{class_client_data}{Client\+Data}} object representing the client connection. \\
\hline
{\em request} & Reference to the {\ttfamily \doxylink{structs__request}{s\+\_\+request}} structure with details about the client\textquotesingle{}s request. \\
\hline
{\em fd} & File descriptor associated with the client connection.\\
\hline
\end{DoxyParams}

\begin{DoxyExceptions}{Exceptions}
{\em \doxylink{class_logger_1_1_no_logger_pointer}{Logger\+::\+No\+Logger\+Pointer}} & if the {\ttfamily log} pointer is {\ttfamily NULL}, indicating that logging is required. \\
\hline
\end{DoxyExceptions}
\Hypertarget{class_ws_response_handler_a8baab27d8124fd3ec88dc9727b280ac7}\index{WsResponseHandler@{WsResponseHandler}!````~WsResponseHandler@{\texorpdfstring{$\sim$}{\string~}WsResponseHandler}}
\index{````~WsResponseHandler@{\texorpdfstring{$\sim$}{\string~}WsResponseHandler}!WsResponseHandler@{WsResponseHandler}}
\doxysubsubsection{\texorpdfstring{\texorpdfstring{$\sim$}{\string~}WsResponseHandler()}{\string~WsResponseHandler()}}
{\footnotesize\ttfamily \label{class_ws_response_handler_a8baab27d8124fd3ec88dc9727b280ac7} 
Ws\+Response\+Handler\+::\texorpdfstring{$\sim$}{\string~}\+Ws\+Response\+Handler (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Destructor for the {\ttfamily \doxylink{class_ws_response_handler}{Ws\+Response\+Handler}} class. 

Cleans up any resources held by the {\ttfamily \doxylink{class_ws_response_handler}{Ws\+Response\+Handler}} instance. Abstract class does not need to free any resource. 

\doxysubsection{Member Function Documentation}
\Hypertarget{class_ws_response_handler_a1b93f248882a4eda90403c83321071a4}\index{WsResponseHandler@{WsResponseHandler}!default\_plain\_error@{default\_plain\_error}}
\index{default\_plain\_error@{default\_plain\_error}!WsResponseHandler@{WsResponseHandler}}
\doxysubsubsection{\texorpdfstring{default\_plain\_error()}{default\_plain\_error()}}
{\footnotesize\ttfamily \label{class_ws_response_handler_a1b93f248882a4eda90403c83321071a4} 
std\+::string Ws\+Response\+Handler\+::default\+\_\+plain\+\_\+error (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Generates a default HTML error page for the HTTP response. 

\hypertarget{class_ws_response_handler_Error}{}\doxysubsection{\texorpdfstring{responses}{responses}}\label{class_ws_response_handler_Error}
This method constructs a basic HTML page with an error message that includes the HTTP status code and a brief description of the error. The error page is returned as a string and can be used as a fallback response in cases where more specific error content is unavailable.

\begin{DoxyReturn}{Returns}
A {\ttfamily std\+::string} containing the default error page in HTML format. 
\end{DoxyReturn}
\Hypertarget{class_ws_response_handler_a13110e781354f17e2628be2c9a5c89ae}\index{WsResponseHandler@{WsResponseHandler}!get\_file\_content@{get\_file\_content}}
\index{get\_file\_content@{get\_file\_content}!WsResponseHandler@{WsResponseHandler}}
\doxysubsubsection{\texorpdfstring{get\_file\_content()}{get\_file\_content()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily \label{class_ws_response_handler_a13110e781354f17e2628be2c9a5c89ae} 
virtual void Ws\+Response\+Handler\+::get\+\_\+file\+\_\+content (\begin{DoxyParamCaption}\item[{int}]{pid}{, }\item[{int(\&)}]{fd}{\mbox{[}2\mbox{]}}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [pure virtual]}}



Implemented in \mbox{\hyperlink{class_http_response_handler_a90ad9e56b3260f3e1b6cd0fbc7dc44fb}{Http\+Response\+Handler}}.

\Hypertarget{class_ws_response_handler_aa5f538a7d770aecb593e27cbae11bebb}\index{WsResponseHandler@{WsResponseHandler}!get\_file\_content@{get\_file\_content}}
\index{get\_file\_content@{get\_file\_content}!WsResponseHandler@{WsResponseHandler}}
\doxysubsubsection{\texorpdfstring{get\_file\_content()}{get\_file\_content()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily \label{class_ws_response_handler_aa5f538a7d770aecb593e27cbae11bebb} 
void Ws\+Response\+Handler\+::get\+\_\+file\+\_\+content (\begin{DoxyParamCaption}\item[{std\+::string \&}]{path}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}



Retrieves the content of a file specified by the path. 



Reimplemented in \mbox{\hyperlink{class_http_response_handler_ab4032ef8152f75d17e3b6add8a86f025}{Http\+Response\+Handler}}.

\Hypertarget{class_ws_response_handler_a1e1d6f36fa589140b0feb50013295720}\index{WsResponseHandler@{WsResponseHandler}!handle\_delete@{handle\_delete}}
\index{handle\_delete@{handle\_delete}!WsResponseHandler@{WsResponseHandler}}
\doxysubsubsection{\texorpdfstring{handle\_delete()}{handle\_delete()}}
{\footnotesize\ttfamily \label{class_ws_response_handler_a1e1d6f36fa589140b0feb50013295720} 
bool Ws\+Response\+Handler\+::handle\+\_\+delete (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Handles HTTP DELETE requests by checking permissions and deleting the specified resource. 

This method processes DELETE requests by verifying that the client has sufficient permissions. If permissions are adequate, it checks the existence of the resource, deletes it, and sends a success response. If any step fails, an error response is sent to the client.

\begin{DoxyReturn}{Returns}
{\ttfamily true} if the resource is successfully deleted and a success response is sent; {\ttfamily false} if an error occurs, such as insufficient permissions, resource not found, or failure to delete the resource. 
\end{DoxyReturn}
\Hypertarget{class_ws_response_handler_aca126bfa03d064a8d94de7ab480b3733}\index{WsResponseHandler@{WsResponseHandler}!handle\_get@{handle\_get}}
\index{handle\_get@{handle\_get}!WsResponseHandler@{WsResponseHandler}}
\doxysubsubsection{\texorpdfstring{handle\_get()}{handle\_get()}}
{\footnotesize\ttfamily \label{class_ws_response_handler_aca126bfa03d064a8d94de7ab480b3733} 
bool Ws\+Response\+Handler\+::handle\+\_\+get (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}



Handles HTTP GET requests, validating access, resource data, and sending a response. 

This method processes GET requests by checking if the client has read access to the location. If access is allowed, it get file content Upon successful validation, \+\_\+response\+\_\+data.\+content is sent to the client. If any step fails, an error response is sent to the client.

\begin{DoxyReturn}{Returns}
{\ttfamily true} if the GET request is successfully handled and the data is properly read; otherwise, {\ttfamily false} if an error occurs or access is denied. 
\end{DoxyReturn}
\Hypertarget{class_ws_response_handler_a644b3ca7a7cec3dc191f182fb47cc68f}\index{WsResponseHandler@{WsResponseHandler}!handle\_post@{handle\_post}}
\index{handle\_post@{handle\_post}!WsResponseHandler@{WsResponseHandler}}
\doxysubsubsection{\texorpdfstring{handle\_post()}{handle\_post()}}
{\footnotesize\ttfamily \label{class_ws_response_handler_a644b3ca7a7cec3dc191f182fb47cc68f} 
bool Ws\+Response\+Handler\+::handle\+\_\+post (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}



Handles HTTP POST requests, validating access, saving data, and sending a response. 

This method processes POST requests by checking if the client has write access to the location. If access is allowed, it validates the payload and resets the client timeout. Upon successful validation, the request body is saved to the specified path, and a success response is sent. If any step fails, an error response is sent to the client.

\begin{DoxyReturn}{Returns}
{\ttfamily true} if the POST request is successfully handled and the data is saved; otherwise, {\ttfamily false} if an error occurs or access is denied. 
\end{DoxyReturn}
\Hypertarget{class_ws_response_handler_ac424b9087f15dc526de36c473dd0b99b}\index{WsResponseHandler@{WsResponseHandler}!handle\_request@{handle\_request}}
\index{handle\_request@{handle\_request}!WsResponseHandler@{WsResponseHandler}}
\doxysubsubsection{\texorpdfstring{handle\_request()}{handle\_request()}}
{\footnotesize\ttfamily \label{class_ws_response_handler_ac424b9087f15dc526de36c473dd0b99b} 
bool Ws\+Response\+Handler\+::handle\+\_\+request (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Handles the incoming HTTP request based on the request method. 



Reimplemented in \mbox{\hyperlink{class_http_auto_index_ac86e61db08b2297750c609ff477ac864}{Http\+Auto\+Index}}, \mbox{\hyperlink{class_http_c_g_i_handler_ae0dbcacc259b7c0d4a3560661e1b3a59}{Http\+CGIHandler}}, \mbox{\hyperlink{class_http_multipart_handler_a238c811869507cc202214d5e34c540d4}{Http\+Multipart\+Handler}}, and \mbox{\hyperlink{class_http_range_handler_a9eb046811130668c9a85d7df2798187e}{Http\+Range\+Handler}}.

\Hypertarget{class_ws_response_handler_a1f6fa4b16b1bb217c5c76f84de70cd0b}\index{WsResponseHandler@{WsResponseHandler}!header@{header}}
\index{header@{header}!WsResponseHandler@{WsResponseHandler}}
\doxysubsubsection{\texorpdfstring{header()}{header()}}
{\footnotesize\ttfamily \label{class_ws_response_handler_a1f6fa4b16b1bb217c5c76f84de70cd0b} 
std\+::string Ws\+Response\+Handler\+::header (\begin{DoxyParamCaption}\item[{int}]{code}{, }\item[{size\+\_\+t}]{content\+\_\+size}{, }\item[{std\+::string}]{mime}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}



Constructs an HTTP response header based on provided parameters. 

\hypertarget{class_ws_response_handler_Response}{}\doxysubsection{\texorpdfstring{Builders}{Builders}}\label{class_ws_response_handler_Response}
This method builds an HTTP response header string with status code, content length, content type, connection type, and range support, if applicable. The method supports connection keep-\/alive if the client is active and the request is valid ({\ttfamily sanity} is true). For ranged responses, the {\ttfamily Content-\/\+Range} and {\ttfamily Accept-\/\+Ranges} headers are included.


\begin{DoxyParams}{Parameters}
{\em code} & HTTP status code for the response. \\
\hline
{\em content\+\_\+size} & Size of the response content in bytes. \\
\hline
{\em mime} & MIME type of the response content. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A fully constructed HTTP response header as a {\ttfamily std\+::string}. 
\end{DoxyReturn}
\Hypertarget{class_ws_response_handler_ac8c8694f89236b819db3906a1e2f1872}\index{WsResponseHandler@{WsResponseHandler}!redirection@{redirection}}
\index{redirection@{redirection}!WsResponseHandler@{WsResponseHandler}}
\doxysubsubsection{\texorpdfstring{redirection()}{redirection()}}
{\footnotesize\ttfamily \label{class_ws_response_handler_ac8c8694f89236b819db3906a1e2f1872} 
bool Ws\+Response\+Handler\+::redirection (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}



Handles HTTP redirection for the current request. 

\hypertarget{class_ws_response_handler_General}{}\doxysubsection{\texorpdfstring{General}{General}}\label{class_ws_response_handler_General}
This method generates an HTTP redirection response based on the redirection information available in the current location configuration ({\ttfamily \+\_\+location-\/\texorpdfstring{$>$}{>}redirections}). It constructs an HTTP response header indicating the redirection status code and the new location URL, and sends it to the client.

\begin{DoxyReturn}{Returns}
{\ttfamily true} if the response was successfully sent, otherwise {\ttfamily false}.
\end{DoxyReturn}
The method follows these steps\+:
\begin{DoxyEnumerate}
\item {\bfseries{Redirection Configuration}}\+:
\begin{DoxyItemize}
\item Retrieves the first redirection entry from {\ttfamily \+\_\+location-\/\texorpdfstring{$>$}{>}redirections} by calling {\ttfamily begin()}.
\end{DoxyItemize}
\item {\bfseries{Generate Redirection Header}}\+:
\begin{DoxyItemize}
\item Constructs an HTTP response header using a {\ttfamily std\+::ostringstream}.
\item Includes\+:
\begin{DoxyItemize}
\item {\bfseries{HTTP Status Line}}\+: Constructs the status line with the status code ({\ttfamily it-\/\texorpdfstring{$>$}{>}first}) and the corresponding reason phrase obtained from {\ttfamily \doxylink{general__helpers_8cpp_a411f70b0adb50fb351494b96143fb0ce}{http\+\_\+status\+\_\+description()}}.
\item {\bfseries{Location Header}}\+: Specifies the new location to which the client should be redirected ({\ttfamily it-\/\texorpdfstring{$>$}{>}second}).
\item {\bfseries{Content-\/\+Length}}\+: Set to {\ttfamily 0}, indicating no body content.
\item {\bfseries{Content-\/\+Type}}\+: Set to {\ttfamily text/html} for compatibility, even though there is no body content.
\end{DoxyItemize}
\end{DoxyItemize}
\item {\bfseries{Send Response}}\+:
\begin{DoxyItemize}
\item Sets {\ttfamily \+\_\+headers} to the constructed redirection header.
\item Calls {\ttfamily \doxylink{class_ws_response_handler_a01217e2efc87284c0642d2a4341fc26b}{sender()}} to send the response to the client, passing an empty string as the body since there is no content.
\end{DoxyItemize}
\end{DoxyEnumerate}

\begin{DoxyNote}{Note}

\begin{DoxyItemize}
\item This method assumes that the redirection configuration ({\ttfamily \+\_\+location-\/\texorpdfstring{$>$}{>}redirections}) is not empty. It uses {\ttfamily begin()} to access the first redirection entry. this is controlled before 
\end{DoxyItemize}
\end{DoxyNote}
\begin{DoxySeeAlso}{See also}
Socket\+Handler\+::mapping\+\_\+redir() 
\end{DoxySeeAlso}
\Hypertarget{class_ws_response_handler_a567d0413981e44eae8146cba69ae8a7a}\index{WsResponseHandler@{WsResponseHandler}!save\_file@{save\_file}}
\index{save\_file@{save\_file}!WsResponseHandler@{WsResponseHandler}}
\doxysubsubsection{\texorpdfstring{save\_file()}{save\_file()}}
{\footnotesize\ttfamily \label{class_ws_response_handler_a567d0413981e44eae8146cba69ae8a7a} 
bool Ws\+Response\+Handler\+::save\+\_\+file (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{save\+\_\+path}{, }\item[{const std\+::string \&}]{content}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Saves the provided content to a specified file path. 

This method attempts to save the given content to a file at the specified path. If the file already exists, an error response is set, as overwriting is not permitted. If the file does not exist, it is created, and the content is written to it. Any errors encountered during file operations will log an error, update the HTTP status, and mark the request as failed.


\begin{DoxyParams}{Parameters}
{\em save\+\_\+path} & The path where the content should be saved. \\
\hline
{\em content} & The content to be written to the file. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily true} if the file is saved successfully; {\ttfamily false} if an error occurs. 
\end{DoxyReturn}
\Hypertarget{class_ws_response_handler_abeedbeb84a4e00fcbf33c1864d7c6a15}\index{WsResponseHandler@{WsResponseHandler}!send\_error\_response@{send\_error\_response}}
\index{send\_error\_response@{send\_error\_response}!WsResponseHandler@{WsResponseHandler}}
\doxysubsubsection{\texorpdfstring{send\_error\_response()}{send\_error\_response()}}
{\footnotesize\ttfamily \label{class_ws_response_handler_abeedbeb84a4e00fcbf33c1864d7c6a15} 
bool Ws\+Response\+Handler\+::send\+\_\+error\+\_\+response (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}



Sends an HTTP error response to the client, using a custom error page if available. 

This method attempts to retrieve a custom error page based on the HTTP status code and location configuration. If a custom error page is defined, it loads and sends that page as the error response. If no custom page is available or an error occurs while loading it, a default error page is generated and sent. The response header is constructed according to the status code, content length, and MIME type.

If a location was not provided, a plain default text will be sent.

\begin{DoxyReturn}{Returns}
{\ttfamily true} if the error response is successfully sent; {\ttfamily false} if an error occurs. 
\end{DoxyReturn}
\Hypertarget{class_ws_response_handler_ac1c7496ce4287eb698166bbe52852cfa}\index{WsResponseHandler@{WsResponseHandler}!send\_response@{send\_response}}
\index{send\_response@{send\_response}!WsResponseHandler@{WsResponseHandler}}
\doxysubsubsection{\texorpdfstring{send\_response()}{send\_response()}}
{\footnotesize\ttfamily \label{class_ws_response_handler_ac1c7496ce4287eb698166bbe52852cfa} 
bool Ws\+Response\+Handler\+::send\+\_\+response (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{body}{, }\item[{const std\+::string \&}]{path}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}



Sends an HTTP response with the specified body content and inferred MIME type. 

This method constructs and sends an HTTP response header and body to the client. The MIME type is determined based on the response data, or inferred from the file path if no MIME type is specified. The response header is created using the status code and content length, after which the full response is sent.


\begin{DoxyParams}{Parameters}
{\em body} & The body content of the response. \\
\hline
{\em path} & The file path used to infer the MIME type if not specified in the response data. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily true} if the response is successfully sent; {\ttfamily false} if sending fails. 
\end{DoxyReturn}
\Hypertarget{class_ws_response_handler_a01217e2efc87284c0642d2a4341fc26b}\index{WsResponseHandler@{WsResponseHandler}!sender@{sender}}
\index{sender@{sender}!WsResponseHandler@{WsResponseHandler}}
\doxysubsubsection{\texorpdfstring{sender()}{sender()}}
{\footnotesize\ttfamily \label{class_ws_response_handler_a01217e2efc87284c0642d2a4341fc26b} 
bool Ws\+Response\+Handler\+::sender (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{body}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Sends the HTTP response to the client through the socket file descriptor. 

This function sends the complete response, including headers and body, to the client. It handles partial writes and ensures that all data is sent correctly by using a loop.

The flow of the function is as follows\+:
\begin{DoxyEnumerate}
\item Concatenate the response headers and body into a single response string.
\item Attempt to send the response data using {\ttfamily send()}.
\item If {\ttfamily send()} returns {\ttfamily -\/1}, retry sending up to a predefined maximum number of times without checking {\ttfamily errno}.
\item Introduce a small delay between retries to avoid a busy-\/wait loop.
\item Accumulate the number of bytes successfully sent and continue until the entire response is sent.
\item If the response is sent successfully, log the details and return true. If it fails after maximum retries, return false.
\end{DoxyEnumerate}


\begin{DoxyParams}{Parameters}
{\em body} & The body content of the HTTP response to be sent. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
True if the response is sent successfully, false otherwise. 
\end{DoxyReturn}
\Hypertarget{class_ws_response_handler_ad11ac0e6036e8a641cfe74569c47314f}\index{WsResponseHandler@{WsResponseHandler}!turn\_off\_sanity@{turn\_off\_sanity}}
\index{turn\_off\_sanity@{turn\_off\_sanity}!WsResponseHandler@{WsResponseHandler}}
\doxysubsubsection{\texorpdfstring{turn\_off\_sanity()}{turn\_off\_sanity()}}
{\footnotesize\ttfamily \label{class_ws_response_handler_ad11ac0e6036e8a641cfe74569c47314f} 
void Ws\+Response\+Handler\+::turn\+\_\+off\+\_\+sanity (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{http__enum__codes_8hpp_a991546140b16a555c1d90caffcb0e390}{e\+\_\+http\+\_\+sts}}}]{status}{, }\item[{std\+::string}]{detail}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Disables further request processing by marking the request as invalid. 

This method is used to set the request\textquotesingle{}s {\ttfamily sanity} flag to {\ttfamily false}, indicating that the request should not continue being processed due to an error. It also sets the HTTP status code for the response, logs the provided error detail, and marks the response data status as invalid.


\begin{DoxyParams}{Parameters}
{\em status} & The HTTP status code representing the error condition. \\
\hline
{\em detail} & A detailed message describing the reason for marking the request as invalid. \\
\hline
\end{DoxyParams}
\Hypertarget{class_ws_response_handler_aaa165d0cdad3ce51a5e1bd755b501277}\index{WsResponseHandler@{WsResponseHandler}!validate\_payload@{validate\_payload}}
\index{validate\_payload@{validate\_payload}!WsResponseHandler@{WsResponseHandler}}
\doxysubsubsection{\texorpdfstring{validate\_payload()}{validate\_payload()}}
{\footnotesize\ttfamily \label{class_ws_response_handler_aaa165d0cdad3ce51a5e1bd755b501277} 
bool Ws\+Response\+Handler\+::validate\+\_\+payload (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}



Validates the payload of an HTTP request to ensure it meets requirements. 

This method checks if the request payload satisfies necessary criteria for processing, specifically for POST requests. It verifies that the {\ttfamily Content-\/\+Length} and {\ttfamily Content-\/\+Type} headers are present, that the request body exists and matches the expected length, and that the file extension is not blacklisted. If any validation fails, the request is marked as invalid and an error response is prepared.

\begin{DoxyReturn}{Returns}
{\ttfamily true} if the payload is valid and ready for further processing; {\ttfamily false} otherwise. 
\end{DoxyReturn}


\doxysubsection{Field Documentation}
\Hypertarget{class_ws_response_handler_ab10cfb3b580bd147399038a7a2431e9b}\index{WsResponseHandler@{WsResponseHandler}!\_client\_data@{\_client\_data}}
\index{\_client\_data@{\_client\_data}!WsResponseHandler@{WsResponseHandler}}
\doxysubsubsection{\texorpdfstring{\_client\_data}{\_client\_data}}
{\footnotesize\ttfamily \label{class_ws_response_handler_ab10cfb3b580bd147399038a7a2431e9b} 
\mbox{\hyperlink{class_client_data}{Client\+Data}}\texorpdfstring{$\ast$}{*} Ws\+Response\+Handler\+::\+\_\+client\+\_\+data\hspace{0.3cm}{\ttfamily [protected]}}

\Hypertarget{class_ws_response_handler_ad89c7d5cc6459655f69f0f4db824757f}\index{WsResponseHandler@{WsResponseHandler}!\_headers@{\_headers}}
\index{\_headers@{\_headers}!WsResponseHandler@{WsResponseHandler}}
\doxysubsubsection{\texorpdfstring{\_headers}{\_headers}}
{\footnotesize\ttfamily \label{class_ws_response_handler_ad89c7d5cc6459655f69f0f4db824757f} 
std\+::string Ws\+Response\+Handler\+::\+\_\+headers\hspace{0.3cm}{\ttfamily [protected]}}

\Hypertarget{class_ws_response_handler_a85c6c1dda9c16243a5cb1cbe7d7981e8}\index{WsResponseHandler@{WsResponseHandler}!\_location@{\_location}}
\index{\_location@{\_location}!WsResponseHandler@{WsResponseHandler}}
\doxysubsubsection{\texorpdfstring{\_location}{\_location}}
{\footnotesize\ttfamily \label{class_ws_response_handler_a85c6c1dda9c16243a5cb1cbe7d7981e8} 
const \mbox{\hyperlink{struct_location_config}{Location\+Config}}\texorpdfstring{$\ast$}{*} Ws\+Response\+Handler\+::\+\_\+location\hspace{0.3cm}{\ttfamily [protected]}}

\Hypertarget{class_ws_response_handler_ad16c39c951b521fbb836260bfdd620b2}\index{WsResponseHandler@{WsResponseHandler}!\_log@{\_log}}
\index{\_log@{\_log}!WsResponseHandler@{WsResponseHandler}}
\doxysubsubsection{\texorpdfstring{\_log}{\_log}}
{\footnotesize\ttfamily \label{class_ws_response_handler_ad16c39c951b521fbb836260bfdd620b2} 
const \mbox{\hyperlink{class_logger}{Logger}}\texorpdfstring{$\ast$}{*} Ws\+Response\+Handler\+::\+\_\+log\hspace{0.3cm}{\ttfamily [protected]}}

\Hypertarget{class_ws_response_handler_a394876bb9233128373d9aa1c2a6fb392}\index{WsResponseHandler@{WsResponseHandler}!\_request@{\_request}}
\index{\_request@{\_request}!WsResponseHandler@{WsResponseHandler}}
\doxysubsubsection{\texorpdfstring{\_request}{\_request}}
{\footnotesize\ttfamily \label{class_ws_response_handler_a394876bb9233128373d9aa1c2a6fb392} 
\mbox{\hyperlink{structs__request}{s\+\_\+request}}\& Ws\+Response\+Handler\+::\+\_\+request\hspace{0.3cm}{\ttfamily [protected]}}

\Hypertarget{class_ws_response_handler_a67ccf1b36d737f643651b8df1d207870}\index{WsResponseHandler@{WsResponseHandler}!\_response\_data@{\_response\_data}}
\index{\_response\_data@{\_response\_data}!WsResponseHandler@{WsResponseHandler}}
\doxysubsubsection{\texorpdfstring{\_response\_data}{\_response\_data}}
{\footnotesize\ttfamily \label{class_ws_response_handler_a67ccf1b36d737f643651b8df1d207870} 
\mbox{\hyperlink{structs__content}{s\+\_\+content}} Ws\+Response\+Handler\+::\+\_\+response\+\_\+data\hspace{0.3cm}{\ttfamily [protected]}}



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
websrv/inc/\mbox{\hyperlink{_web_server_response_handler_8hpp}{Web\+Server\+Response\+Handler.\+hpp}}\item 
websrv/srcs/\mbox{\hyperlink{_web_server_response_handler_8cpp}{Web\+Server\+Response\+Handler.\+cpp}}\end{DoxyCompactItemize}
